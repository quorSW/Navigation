<!DOCTYPE html>

<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no">
<meta name="theme-color" content="#07070f">
<title>INVESTAT</title>
<script src="https://telegram.org/js/telegram-web-app.js"></script>
<link href="https://fonts.googleapis.com/css2?family=Unbounded:wght@400;600;700;900&family=Manrope:wght@400;500;600;700;800&display=swap" rel="stylesheet">

<!-- Firebase SDK -->

<script type="module">
import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js';
import {
  getFirestore, doc, setDoc, getDoc, getDocs,
  collection, onSnapshot, increment, updateDoc,
  deleteDoc, serverTimestamp, arrayUnion, addDoc
} from 'https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js';

const cfg = {
  apiKey:            "AIzaSyBvPOFlJsnO5BNYLdRdA-Db4uvXT8QIwXQ",
  authDomain:        "navigation-a08ba.firebaseapp.com",
  databaseURL:       "https://navigation-a08ba-default-rtdb.firebaseio.com",
  projectId:         "navigation-a08ba",
  storageBucket:     "navigation-a08ba.firebasestorage.app",
  messagingSenderId: "988049632333",
  appId:             "1:988049632333:web:c1049f11704842a3d68004",
  measurementId:     "G-TS21Y81VVF"
};
try {
  const app = initializeApp(cfg);
  const db  = getFirestore(app);
  window.FS            = db;
  window.fsDoc         = doc;
  window.fsSetDoc      = setDoc;
  window.fsGetDoc      = getDoc;
  window.fsGetDocs     = getDocs;
  window.fsColl        = collection;
  window.fsSnap        = onSnapshot;
  window.fsInc         = increment;
  window.fsUpdate      = updateDoc;
  window.fsDelete      = deleteDoc;
  window.fsTs          = serverTimestamp;
  window.fsUnion       = arrayUnion;
  window.fsAdd         = addDoc;
  window.FB_READY      = true;
  console.log('Firebase OK');
} catch(e) {
  window.FB_READY = false;
  console.warn('Firebase fail', e);
}
</script>

<style>
*,*::before,*::after{box-sizing:border-box;margin:0;padding:0;-webkit-tap-highlight-color:transparent}
html,body{
  font-family:'Manrope',sans-serif;
  background:#07070f;color:#eeeeff;
  height:100%;overflow:hidden;
  color-scheme:dark;
}
:root{
  --acc:#3d5af1;--acc2:#6c3de8;
  --bg:#07070f;--bg2:#0c0c1a;--bg3:#111122;--bg4:#18182a;
  --brd:rgba(255,255,255,.07);--brd2:rgba(255,255,255,.12);
  --txt:#eeeeff;--txt2:#7777aa;--txt3:#3a3a60;
  --grn:#0baa6e;--red:#e03050;--gold:#d4a011;
  --glow:rgba(61,90,241,.3);
  --tab:62px;
}

/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê SCREENS ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
.screen{display:none;height:100vh;flex-direction:column;background:var(--bg)}
.screen.active{display:flex}

/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê AUTH ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
#auth{position:relative;overflow:hidden;align-items:center;justify-content:center}
#auth .orb1{position:absolute;top:-80px;right:-60px;width:300px;height:300px;border-radius:50%;background:radial-gradient(circle,rgba(61,90,241,.2),transparent 70%);pointer-events:none}
#auth .orb2{position:absolute;bottom:-60px;left:-80px;width:260px;height:260px;border-radius:50%;background:radial-gradient(circle,rgba(108,61,232,.15),transparent 70%);pointer-events:none}
#auth-scroll{width:100%;height:100%;overflow-y:auto;-webkit-overflow-scrolling:touch;padding:0 20px 48px;position:relative;z-index:1}

.a-logo{display:flex;flex-direction:column;align-items:center;padding:44px 0 28px}
.a-icon{width:68px;height:68px;border-radius:20px;background:linear-gradient(135deg,var(--acc),var(--acc2));display:flex;align-items:center;justify-content:center;box-shadow:0 0 40px var(--glow);margin-bottom:14px}
.a-name{font-family:'Unbounded',sans-serif;font-size:21px;font-weight:700;letter-spacing:.02em}
.a-sub{font-size:12px;color:var(--txt2);margin-top:4px}

/* Seg control */
.seg{display:flex;background:var(--bg3);border-radius:13px;padding:3px;margin-bottom:22px}
.seg-btn{flex:1;padding:11px;border:none;border-radius:10px;background:transparent;color:var(--txt2);font-family:'Manrope',sans-serif;font-size:13px;font-weight:700;cursor:pointer;transition:all .2s}
.seg-btn.on{background:linear-gradient(135deg,var(--acc),var(--acc2));color:#fff;box-shadow:0 3px 16px var(--glow)}

/* Fields */
.fg{margin-bottom:14px}
.fl{font-size:11px;font-weight:700;color:var(--txt2);margin-bottom:6px;text-transform:uppercase;letter-spacing:.06em;display:flex;align-items:center;gap:5px}
.fw{position:relative}
.fi{
  width:100%;padding:14px 44px 14px 44px;
  background:var(--bg4);border:1.5px solid rgba(255,255,255,.1);
  border-radius:12px;color:var(--txt);font-family:'Manrope',sans-serif;
  font-size:14px;font-weight:500;outline:none;
  -webkit-appearance:none;caret-color:var(--acc);
  -webkit-text-fill-color:var(--txt);
  box-shadow:inset 0 0 0 9999px var(--bg4);
}
.fi:focus{border-color:var(--acc)}
.fi.err{border-color:var(--red)}
.fi::placeholder{color:var(--txt3);-webkit-text-fill-color:var(--txt3)}
.fi:-webkit-autofill,.fi:-webkit-autofill:focus{
  -webkit-text-fill-color:var(--txt)!important;
  -webkit-box-shadow:0 0 0 9999px var(--bg4) inset!important;
}
.fi-ico{position:absolute;left:13px;top:50%;transform:translateY(-50%);opacity:.35;display:flex;color:var(--txt);pointer-events:none}
.fi-eye{position:absolute;right:12px;top:50%;transform:translateY(-50%);background:none;border:none;cursor:pointer;opacity:.3;color:var(--txt);display:flex}

.hint{font-size:11px;margin-top:4px;padding-left:2px;min-height:16px;color:transparent}
.hint.ok{color:var(--grn)}
.hint.er{color:var(--red)}
.sbar{height:3px;border-radius:2px;background:var(--bg4);margin-top:6px;overflow:hidden}
.sbar-fill{height:100%;border-radius:2px;width:0;transition:width .3s,background .3s}
.aerr{display:none;padding:12px 14px;border-radius:11px;font-size:12px;font-weight:600;line-height:1.5;margin-bottom:14px;background:rgba(224,48,80,.1);border:1px solid rgba(224,48,80,.22);color:#ff8099}
.aerr.show{display:block}

.a-btn{
  width:100%;padding:16px;margin-top:8px;
  background:linear-gradient(135deg,var(--acc),var(--acc2));
  border:none;border-radius:12px;color:#fff;
  font-family:'Unbounded',sans-serif;font-size:12px;font-weight:700;
  cursor:pointer;letter-spacing:.05em;box-shadow:0 4px 24px var(--glow);
  transition:opacity .15s,transform .15s;
}
.a-btn:active{transform:scale(.97);opacity:.9}
.a-btn:disabled{opacity:.6;cursor:default}
.a-legal{text-align:center;margin-top:16px;font-size:11px;color:var(--txt3);line-height:1.6}

/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê APP SHELL ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
#app{background:var(--bg)}
.topbar{
  display:flex;align-items:center;justify-content:space-between;
  padding:12px 16px 10px;background:var(--bg2);
  border-bottom:1px solid var(--brd);flex-shrink:0;
}
.topbar-t{font-family:'Unbounded',sans-serif;font-size:15px;font-weight:700}
.topav{
  width:36px;height:36px;border-radius:50%;
  background:linear-gradient(135deg,var(--acc),var(--acc2));
  display:flex;align-items:center;justify-content:center;
  font-family:'Unbounded',sans-serif;font-size:13px;font-weight:700;
  cursor:pointer;box-shadow:0 2px 10px var(--glow);
}

.page{display:none;flex:1;overflow-y:auto;-webkit-overflow-scrolling:touch;padding-bottom:calc(var(--tab)+80px);background:var(--bg)}
.page.active{display:block}
#page-ambassadors{padding-bottom:calc(var(--tab)+120px)}

/* Bottom nav */
.bnav{
  position:fixed;bottom:0;left:0;right:0;
  background:var(--bg2);border-top:1px solid var(--brd);
  display:none;align-items:stretch;z-index:50;
  padding-bottom:env(safe-area-inset-bottom,0);
}
#app.active .bnav{display:flex}
.ntab{
  flex:1;display:flex;flex-direction:column;align-items:center;justify-content:center;
  gap:3px;padding:9px 4px;cursor:pointer;color:var(--txt3);
  border:none;background:none;min-height:var(--tab);font-size:10px;
  font-family:'Manrope',sans-serif;font-weight:600;transition:color .15s;
}
.ntab.on{color:var(--acc)}
.ntab svg{width:22px;height:22px}

/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê HERO ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
.hero{margin:12px;border-radius:18px;overflow:hidden;position:relative;height:165px;background:linear-gradient(135deg,#0a1855,#1e3a8a,#070720)}
.hero-glow1{position:absolute;top:-30px;right:-30px;width:200px;height:200px;border-radius:50%;background:radial-gradient(circle,rgba(61,90,241,.5),transparent 65%);animation:pulse 4s ease-in-out infinite}
.hero-glow2{position:absolute;bottom:-40px;left:20px;width:150px;height:150px;border-radius:50%;background:radial-gradient(circle,rgba(108,61,232,.3),transparent 65%);animation:pulse 4s ease-in-out infinite .8s}
@keyframes pulse{0%,100%{transform:scale(1)}50%{transform:scale(1.1)}}
.hero-cnt{position:relative;z-index:2;padding:18px;height:100%;display:flex;flex-direction:column;justify-content:space-between}
.hero-title{font-family:'Unbounded',sans-serif;font-size:18px;font-weight:700;color:#fff}
.hero-sub{font-size:12px;color:rgba(255,255,255,.65);margin-top:4px}
.hero-pills{display:flex;gap:6px;flex-wrap:wrap}
.hero-pill{background:rgba(255,255,255,.13);border-radius:7px;padding:5px 10px;font-size:10px;font-weight:600;color:#fff}

/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê SEARCH ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
.srch-wrap{margin:0 12px 12px;position:relative}
.srch-ico{position:absolute;left:13px;top:50%;transform:translateY(-50%);opacity:.35;color:var(--txt)}
.srch-inp{
  width:100%;padding:12px 14px 12px 42px;
  background:var(--bg4)!important;box-shadow:inset 0 0 0 9999px var(--bg4)!important;
  border:1.5px solid var(--brd2);border-radius:12px;
  color:var(--txt)!important;-webkit-text-fill-color:var(--txt)!important;
  font-family:'Manrope',sans-serif;font-size:14px;outline:none;-webkit-appearance:none;
}
.chips{display:flex;gap:7px;padding:0 12px;overflow-x:auto;scrollbar-width:none;margin-bottom:14px}
.chips::-webkit-scrollbar{display:none}
.chip{padding:6px 14px;border-radius:20px;background:var(--bg4);border:1px solid var(--brd2);color:var(--txt2);font-size:12px;font-weight:600;cursor:pointer;white-space:nowrap;flex-shrink:0;transition:all .15s}
.chip.on{background:var(--acc);border-color:var(--acc);color:#fff}

/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê CARDS ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
.sec{font-family:'Unbounded',sans-serif;font-size:10px;font-weight:700;letter-spacing:.1em;color:var(--txt2);text-transform:uppercase;padding:0 12px;margin:18px 0 10px}
.catgrid{display:grid;grid-template-columns:1fr 1fr;gap:8px;padding:0 12px}
.ccard{border-radius:16px;overflow:hidden;position:relative;cursor:pointer;height:115px;transition:transform .18s}
.ccard:active{transform:scale(.97)}
.ccard-ov{position:absolute;inset:0;background:linear-gradient(160deg,rgba(0,0,0,.15),rgba(0,0,0,.55))}
.ccard-ico{position:absolute;top:10px;right:10px;opacity:.7}
.ccard-body{position:absolute;bottom:0;left:0;right:0;padding:10px 13px 12px;z-index:2}
.ccard-cnt{font-size:10px;color:rgba(255,255,255,.6);font-weight:600;margin-bottom:2px}
.ccard-name{font-family:'Unbounded',sans-serif;font-size:12px;font-weight:700;color:#fff}

.pcards{padding:0 12px}
.pcard{background:#fff;border-radius:16px;margin-bottom:10px;cursor:pointer;overflow:hidden;box-shadow:0 2px 16px rgba(0,0,0,.25);transition:transform .15s}
.pcard:active{transform:scale(.98)}
.pcard-img{height:100px;display:flex;align-items:center;justify-content:center;position:relative}
.pcard-img-ov{position:absolute;bottom:0;left:0;right:0;height:60px;background:linear-gradient(to top,rgba(0,0,0,.4),transparent)}
.pcard-body{padding:13px 14px 14px;background:#fff}
.pcard-top{display:flex;gap:8px;align-items:flex-start;margin-bottom:6px}
.pcard-title{font-size:13px;font-weight:700;color:#111;flex:1;line-height:1.4}
.pcard-prev{font-size:12px;color:#555;line-height:1.5;margin-bottom:8px;display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;overflow:hidden}
.pcard-foot{display:flex;align-items:center;gap:6px;flex-wrap:wrap}

.rlist{padding:0 12px}
.rpost{display:flex;gap:10px;align-items:flex-start;padding:12px;border-radius:13px;background:var(--bg3);border:1px solid var(--brd);margin-bottom:8px;cursor:pointer;transition:opacity .15s}
.rpost:active{opacity:.7}
.rthumb{width:44px;height:44px;border-radius:10px;flex-shrink:0;display:flex;align-items:center;justify-content:center}
.rt2{font-size:13px;font-weight:600;color:var(--txt);line-height:1.4;margin-bottom:4px}
.rm{display:flex;align-items:center;gap:6px}

.badge{padding:3px 9px;border-radius:6px;font-size:10px;font-weight:700;letter-spacing:.04em;text-transform:uppercase}
.b-invest{background:rgba(61,90,241,.15);color:#818cf8}
.b-case{background:rgba(108,61,232,.15);color:#c084fc}
.b-video{background:rgba(11,170,110,.15);color:#34d399}
.b-post{background:rgba(212,160,17,.15);color:#fbbf24}
.b-news{background:rgba(14,120,190,.15);color:#60a5fa}
.tag{font-size:10px;color:var(--txt2);background:rgba(255,255,255,.06);padding:3px 8px;border-radius:5px}

.favbtn{background:none;border:none;cursor:pointer;display:flex;align-items:center;justify-content:center;width:28px;height:28px;flex-shrink:0;transition:transform .2s}
.favbtn:active{transform:scale(1.2)}

/* Referral banner */
.refb{margin:0 12px 4px;background:var(--bg4);border:1px solid var(--brd2);border-radius:14px;padding:13px;display:flex;align-items:center;gap:10px}
.rbico{width:36px;height:36px;border-radius:10px;background:linear-gradient(135deg,var(--acc),var(--acc2));display:flex;align-items:center;justify-content:center;flex-shrink:0}
.rbt{flex:1;min-width:0}
.rbth{font-size:13px;font-weight:700;color:var(--txt);margin-bottom:3px}
.rbtl{font-size:11px;color:var(--txt2);overflow:hidden;text-overflow:ellipsis;white-space:nowrap}
.rbcp{background:var(--bg3);border:1px solid var(--brd2);border-radius:8px;padding:7px 10px;display:flex;align-items:center;gap:4px;font-size:11px;font-weight:600;color:var(--txt2);cursor:pointer;flex-shrink:0;white-space:nowrap;transition:all .25s}
.rbcp.copied{background:rgba(11,170,110,.1);border-color:rgba(11,170,110,.3);color:#34d399}

/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê POST DETAIL ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
#det{position:fixed;inset:0;background:#0e0e18;z-index:100;overflow-y:auto;-webkit-overflow-scrolling:touch;transform:translateX(100%);transition:transform .3s ease}
#det.show{transform:translateX(0)}
.dhead{padding:11px 14px;display:flex;align-items:center;gap:10px;border-bottom:1px solid var(--brd);position:sticky;top:0;background:#0e0e18;z-index:10}
.dback{width:36px;height:36px;border-radius:10px;background:var(--bg3);border:none;cursor:pointer;display:flex;align-items:center;justify-content:center;color:var(--txt2)}
.dht{font-size:14px;font-weight:700;flex:1;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}
.dhero{height:180px;display:flex;align-items:center;justify-content:center;position:relative}
.dhero-ov{position:absolute;bottom:0;left:0;right:0;height:80px;background:linear-gradient(to top,#0e0e18,transparent);z-index:2}
.dcnt{padding:18px 18px 28px;background:#0e0e18}
.dtitle{font-family:'Unbounded',sans-serif;font-size:16px;font-weight:700;line-height:1.4;margin-bottom:12px;color:var(--txt)}
.dbody{font-size:14px;line-height:1.8;color:rgba(238,238,255,.8);white-space:pre-wrap;margin-bottom:14px}
.dtags{display:flex;flex-wrap:wrap;gap:6px;margin-bottom:20px}
.dactions{display:flex;gap:10px;margin-top:8px}
.dbtn{flex:1;display:flex;align-items:center;justify-content:center;gap:8px;padding:16px;border-radius:14px;border:none;cursor:pointer;font-family:'Manrope',sans-serif;font-size:14px;font-weight:700;text-decoration:none;background:#fff;color:#0a0a1a;box-shadow:0 2px 12px rgba(0,0,0,.3);transition:transform .15s}
.dbtn:active{transform:scale(.97)}

/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê COMMUNITY ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
.clist{padding:0 12px}
.ci{display:flex;align-items:center;gap:12px;padding:14px;background:var(--bg3);border-radius:13px;border:1px solid var(--brd);margin-bottom:8px;cursor:pointer;transition:opacity .15s}
.ci:active{opacity:.7}
.ciico{width:44px;height:44px;border-radius:12px;display:flex;align-items:center;justify-content:center;flex-shrink:0}
.cit{font-size:14px;font-weight:700;color:var(--txt);margin-bottom:2px}
.cis{font-size:12px;color:var(--txt2)}
.ciarr{color:var(--txt3);flex-shrink:0}
.csec{font-family:'Unbounded',sans-serif;font-size:10px;font-weight:700;letter-spacing:.08em;color:var(--txt2);text-transform:uppercase;padding:0 12px;margin:16px 0 8px}

/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê AMBASSADORS ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
.amhdr{margin:12px;border-radius:16px;padding:20px;background:linear-gradient(135deg,#0a1855,#1e3a8a);position:relative;overflow:hidden}
.amhdr-gl{position:absolute;top:-20px;right:-20px;width:160px;height:160px;border-radius:50%;background:radial-gradient(circle,rgba(61,90,241,.5),transparent 65%)}
.amhdr-t{font-family:'Unbounded',sans-serif;font-size:16px;font-weight:700;color:#fff;position:relative;z-index:1}
.amhdr-s{font-size:12px;color:rgba(255,255,255,.65);margin-top:4px;position:relative;z-index:1}
.amprof{margin:0 12px 10px;background:var(--bg3);border-radius:14px;border:1px solid var(--brd);padding:15px}
.ampt{display:flex;align-items:center;gap:12px;margin-bottom:12px}
.amav{width:48px;height:48px;border-radius:50%;background:linear-gradient(135deg,var(--acc),var(--acc2));display:flex;align-items:center;justify-content:center;font-family:'Unbounded',sans-serif;font-size:18px;font-weight:700;color:#fff}
.amname{font-size:15px;font-weight:700;color:var(--txt)}
.amlvl{font-size:12px;color:var(--txt2);margin-top:2px}
.amstats{display:grid;grid-template-columns:1fr 1fr 1fr;gap:8px}
.asb{background:var(--bg);border-radius:10px;padding:11px 8px;text-align:center;border:1px solid var(--brd)}
.asn{font-family:'Unbounded',sans-serif;font-size:18px;font-weight:700;color:var(--txt)}
.asl{font-size:10px;color:var(--txt2);margin-top:3px}

.lvlrow{display:flex;gap:8px;padding:0 12px;overflow-x:auto;scrollbar-width:none;margin-bottom:4px}
.lvlrow::-webkit-scrollbar{display:none}
.lvlcard{flex-shrink:0;width:108px;border-radius:12px;padding:12px 10px;border:1.5px solid var(--brd);background:var(--bg4);text-align:center;transition:all .2s}
.lvlcard.active{border-color:var(--acc);background:rgba(61,90,241,.1)}
.lvl-e{font-size:22px;margin-bottom:6px}
.lvl-n{font-size:11px;font-weight:700;color:var(--txt);margin-bottom:4px}
.lvl-r{font-size:10px;color:var(--txt2)}

.pgbox{margin:0 12px 10px;background:var(--bg3);border-radius:13px;border:1px solid var(--brd);padding:14px}
.pgbar{height:6px;border-radius:4px;background:var(--bg);overflow:hidden;margin:8px 0}
.pgfill{height:100%;border-radius:4px;background:linear-gradient(90deg,var(--acc),var(--acc2));width:0;transition:width 1.2s ease}
.pgt{font-size:12px;font-weight:700;color:var(--txt)}
.pgs{font-size:11px;color:var(--txt2);margin-top:4px}

.amref{margin:0 12px 10px;background:var(--bg3);border-radius:13px;border:1px solid var(--brd);padding:14px}
.amrh{font-size:12px;font-weight:700;color:var(--txt2);margin-bottom:10px;display:flex;align-items:center;gap:6px}
.amrl{background:var(--bg);border-radius:9px;padding:10px 12px;font-size:12px;color:var(--txt2);display:flex;align-items:center;justify-content:space-between;cursor:pointer;gap:8px;border:1px solid var(--brd)}
.amrl-t{overflow:hidden;text-overflow:ellipsis;white-space:nowrap;flex:1}
.amrl-cp{display:flex;align-items:center;gap:4px;font-size:11px;font-weight:600;color:var(--txt2);padding:5px 8px;border-radius:7px;border:1px solid var(--brd2);background:var(--bg3);flex-shrink:0;transition:all .25s}
.amrl-cp.copied{background:rgba(11,170,110,.1);border-color:rgba(11,170,110,.3);color:#34d399}

/* Leaderboard */
.lb{margin:0 12px}
.lbi{display:flex;align-items:center;gap:10px;padding:12px;background:var(--bg3);border-radius:12px;border:1px solid var(--brd);margin-bottom:7px}
.lbi.me{border-color:rgba(61,90,241,.4);background:rgba(61,90,241,.07)}
.lbr{font-family:'Unbounded',sans-serif;font-size:12px;font-weight:700;width:24px;text-align:center;flex-shrink:0;color:var(--txt2)}
.lbr.r1{color:#ffd700}.lbr.r2{color:#c0c0c0}.lbr.r3{color:#cd7f32}
.lbav{width:36px;height:36px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-weight:700;font-size:14px;color:#fff;flex-shrink:0}
.lbn{font-size:13px;font-weight:600;color:var(--txt);flex:1}
.lbn.me{color:var(--acc)}
.lbs{font-family:'Unbounded',sans-serif;font-size:14px;font-weight:700;color:var(--txt)}

.amout{margin:10px 12px 24px;padding:14px;background:rgba(224,48,80,.09);border:1px solid rgba(224,48,80,.2);border-radius:13px;color:#ff8099;font-size:13px;font-weight:600;cursor:pointer;text-align:center}

/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê EMPTY ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
.empty{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:60px 24px;text-align:center;gap:8px}
.empty-t{font-family:'Unbounded',sans-serif;font-size:14px;color:var(--txt)}
.empty-s{font-size:12px;color:var(--txt2)}

/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê TOAST ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
.toast{position:fixed;bottom:calc(var(--tab)+14px);left:50%;transform:translateX(-50%) translateY(14px);background:var(--bg4);border:1px solid var(--brd2);border-radius:12px;padding:10px 18px;font-size:12px;font-weight:600;color:var(--txt);opacity:0;transition:all .3s;z-index:999;white-space:nowrap;pointer-events:none}
.toast.show{opacity:1;transform:translateX(-50%) translateY(0)}

/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê ADMIN ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
#admin-fab{display:none;position:fixed;bottom:calc(var(--tab)+16px);right:16px;width:52px;height:52px;border-radius:50%;background:linear-gradient(135deg,var(--acc),var(--acc2));border:none;cursor:pointer;z-index:51;box-shadow:0 4px 20px var(--glow);color:#fff;align-items:center;justify-content:center}
#admin-fab.visible{display:flex!important;align-items:center;justify-content:center}
#admin-panel{display:none;position:fixed;inset:0;background:var(--bg);z-index:300;overflow-y:auto;-webkit-overflow-scrolling:touch}
.adm-head{padding:14px 16px;display:flex;align-items:center;gap:10px;border-bottom:1px solid var(--brd);position:sticky;top:0;background:var(--bg);z-index:10}
.adm-back{width:36px;height:36px;border-radius:10px;background:var(--bg3);border:none;cursor:pointer;display:flex;align-items:center;justify-content:center;color:var(--txt2)}
.adm-tabs{display:flex;border-bottom:1px solid var(--brd);padding:0 16px}
.adm-tab{flex:1;padding:12px 0;background:none;border:none;border-bottom:2px solid transparent;color:var(--txt2);font-size:12px;font-weight:700;cursor:pointer;font-family:'Manrope',sans-serif;transition:all .2s}
.adm-tab.on{color:var(--acc);border-bottom-color:var(--acc)}
.adm-field{margin-bottom:12px}
.adm-field label{display:block;font-size:11px;font-weight:700;color:var(--txt2);margin-bottom:5px;text-transform:uppercase;letter-spacing:.04em}
.adm-field input,.adm-field textarea,.adm-field select{width:100%;background:var(--bg4);border:1px solid var(--brd2);border-radius:10px;padding:10px 12px;color:var(--txt);font-size:13px;font-family:'Manrope',sans-serif;outline:none;box-sizing:border-box;resize:vertical}
.adm-field select{-webkit-appearance:none;cursor:pointer}
.adm-submit{width:100%;padding:13px;background:linear-gradient(135deg,var(--acc),var(--acc2));border:none;border-radius:12px;color:#fff;font-size:14px;font-weight:700;cursor:pointer;font-family:'Manrope',sans-serif;margin-top:4px;transition:opacity .2s}
.adm-submit:disabled{opacity:.6}
.adm-post-row{background:var(--bg3);border-radius:12px;padding:12px;margin-bottom:8px;border:1px solid var(--brd);display:flex;align-items:center;gap:10px}
.adm-post-del{width:32px;height:32px;border-radius:8px;background:rgba(224,48,80,.1);border:none;cursor:pointer;display:flex;align-items:center;justify-content:center;color:var(--red);flex-shrink:0}
.adm-post-restore{width:32px;height:32px;border-radius:8px;background:rgba(11,170,110,.1);border:none;cursor:pointer;display:flex;align-items:center;justify-content:center;color:var(--grn);flex-shrink:0;font-size:15px}
.adm-user-row{background:var(--bg3);border-radius:13px;padding:13px;margin-bottom:10px;border:1px solid var(--brd)}
.adm-user-top{display:flex;align-items:center;gap:10px;margin-bottom:10px}
.adm-av{width:40px;height:40px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-weight:700;font-size:16px;color:#fff;flex-shrink:0}
.adm-block-btn{padding:6px 12px;border-radius:8px;border:none;font-size:11px;font-weight:700;cursor:pointer;font-family:'Manrope',sans-serif;margin-left:auto;flex-shrink:0}
.adm-block-btn.block{background:rgba(224,48,80,.15);color:#ff8099}
.adm-block-btn.unblock{background:rgba(11,170,110,.15);color:#34d399}
.blocked-badge{background:rgba(224,48,80,.2);color:#ff6080;font-size:10px;padding:2px 7px;border-radius:5px;font-weight:700;margin-left:6px}
.adm-user-stats{display:flex;gap:8px;flex-wrap:wrap;margin-bottom:10px}
.adm-stat{font-size:11px;color:var(--txt2);background:var(--bg);padding:4px 8px;border-radius:7px;border:1px solid var(--brd)}
.adm-stat b{color:var(--txt)}
.adm-tgid{background:var(--bg);border-radius:9px;padding:10px 12px;font-size:13px;font-weight:700;color:#818cf8;font-family:monospace;margin-bottom:8px;border:1px solid var(--brd)}
.adm-ref-btn{width:100%;padding:8px;background:rgba(61,90,241,.1);border:1px solid rgba(61,90,241,.25);border-radius:8px;color:#818cf8;font-size:11px;font-weight:700;cursor:pointer;font-family:'Manrope',sans-serif}

/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê CONFIRM OVERLAY ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
.confirm-overlay{position:fixed;inset:0;background:rgba(0,0,0,.75);z-index:9999;display:flex;align-items:center;justify-content:center;padding:20px}
.confirm-box{background:#1a1a2e;border-radius:16px;padding:24px;max-width:300px;width:100%;text-align:center;border:1px solid rgba(255,255,255,.1)}
.confirm-row{display:flex;gap:10px;margin-top:16px}
.confirm-cancel{flex:1;padding:12px;background:var(--bg3);border:1px solid var(--brd2);border-radius:10px;color:var(--txt2);font-size:13px;font-weight:600;cursor:pointer;font-family:'Manrope',sans-serif}
.confirm-ok{flex:1;padding:12px;background:linear-gradient(135deg,#e03050,#c02040);border:none;border-radius:10px;color:#fff;font-size:13px;font-weight:700;cursor:pointer;font-family:'Manrope',sans-serif}

/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê PROJECTS ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
.pjitem{display:flex;align-items:center;gap:12px;padding:14px;background:var(--bg3);border-radius:13px;border:1px solid var(--brd);margin-bottom:8px;cursor:pointer;transition:opacity .15s}
.pjitem:active{opacity:.7}
.pjav{width:44px;height:44px;border-radius:12px;display:flex;align-items:center;justify-content:center;flex-shrink:0}
.pjt{font-size:14px;font-weight:700;color:var(--txt)}
.pjs{font-size:12px;color:var(--txt2);margin-top:2px}
.pjbdg{background:var(--acc);border-radius:20px;padding:2px 8px;font-size:10px;font-weight:700;color:#fff;margin-left:auto;flex-shrink:0}
</style>

</head>
<body>

<!-- SVG –∏–∫–æ–Ω–∫–∏ -->

<svg width="0" height="0" style="position:absolute;overflow:hidden">
<defs>
<symbol id="i-coin" viewBox="0 0 60 60"><circle cx="30" cy="30" r="26" fill="currentColor" opacity=".25"/><circle cx="30" cy="30" r="20" fill="currentColor" opacity=".4"/><text x="30" y="37" text-anchor="middle" font-size="18" font-weight="900" fill="white" opacity=".9">‚ÇΩ</text></symbol>
<symbol id="i-build" viewBox="0 0 60 60"><rect x="6" y="22" width="15" height="32" fill="currentColor" opacity=".8"/><rect x="24" y="12" width="18" height="42" fill="currentColor"/><rect x="45" y="28" width="12" height="26" fill="currentColor" opacity=".7"/></symbol>
<symbol id="i-chart" viewBox="0 0 60 60"><rect x="5" y="42" width="10" height="14" rx="2" fill="currentColor" opacity=".6"/><rect x="19" y="30" width="10" height="26" rx="2" fill="currentColor" opacity=".75"/><rect x="33" y="18" width="10" height="38" rx="2" fill="currentColor" opacity=".9"/><rect x="47" y="8" width="10" height="48" rx="2" fill="currentColor"/></symbol>
<symbol id="i-play" viewBox="0 0 60 60"><circle cx="30" cy="30" r="24" fill="currentColor" opacity=".2"/><circle cx="30" cy="30" r="18" fill="currentColor" opacity=".4"/><polygon points="25,22 45,30 25,38" fill="white" opacity=".85"/></symbol>
<symbol id="i-news" viewBox="0 0 60 60"><rect x="8" y="10" width="36" height="42" rx="3" fill="currentColor" opacity=".7"/><rect x="13" y="17" width="22" height="5" rx="2" fill="white" opacity=".5"/><rect x="13" y="26" width="17" height="3" rx="1.5" fill="white" opacity=".35"/><rect x="13" y="33" width="20" height="3" rx="1.5" fill="white" opacity=".3"/></symbol>
<symbol id="i-edu" viewBox="0 0 60 60"><rect x="10" y="10" width="28" height="42" rx="2" fill="currentColor" opacity=".8"/><rect x="38" y="10" width="14" height="42" rx="2" fill="currentColor" opacity=".5"/><rect x="15" y="17" width="18" height="3.5" rx="1.5" fill="white" opacity=".5"/><rect x="15" y="25" width="14" height="3" rx="1.5" fill="white" opacity=".4"/></symbol>
</defs>
</svg>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
     –≠–ö–†–ê–ù –ê–í–¢–û–†–ò–ó–ê–¶–ò–ò
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->

<div id="auth" class="screen">
  <div class="orb1"></div>
  <div class="orb2"></div>
  <div id="auth-scroll">
    <div class="a-logo">
      <div class="a-icon">
        <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="1.8" stroke-linecap="round"><line x1="12" y1="2" x2="12" y2="22"/><path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"/></svg>
      </div>
      <div class="a-name">INVESTAT</div>
      <div class="a-sub">–ê–Ω–∞–ª–∏—Ç–∏–∫–∞ –¥–æ—Ö–æ–¥–Ω–æ–π –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç–∏</div>
    </div>

```
<div class="seg">
  <button class="seg-btn on" id="btn-login" onclick="showTab('login')">–í–æ–π—Ç–∏</button>
  <button class="seg-btn" id="btn-reg" onclick="showTab('reg')">–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</button>
</div>

<!-- –í–•–û–î -->
<div id="form-login">
  <div class="aerr" id="err-login"></div>
  <div class="fg">
    <div class="fl">Email</div>
    <div class="fw">
      <span class="fi-ico"><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="2" y="4" width="20" height="16" rx="2"/><path d="m22 7-10 7L2 7"/></svg></span>
      <input class="fi" type="email" id="l-email" placeholder="example@mail.ru" autocomplete="email" inputmode="email">
    </div>
  </div>
  <div class="fg">
    <div class="fl">–ü–∞—Ä–æ–ª—å</div>
    <div class="fw">
      <span class="fi-ico"><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="11" width="18" height="11" rx="2"/><path d="M7 11V7a5 5 0 0 1 10 0v4"/></svg></span>
      <input class="fi" type="password" id="l-pass" placeholder="–í–∞—à –ø–∞—Ä–æ–ª—å" autocomplete="current-password">
      <button class="fi-eye" type="button" onclick="toggleEye('l-pass',this)"><svg width="17" height="17" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"/><circle cx="12" cy="12" r="3"/></svg></button>
    </div>
  </div>
  <button class="a-btn" id="btn-do-login" onclick="doLogin()">–í–û–ô–¢–ò –í –ê–ö–ö–ê–£–ù–¢</button>
</div>

<!-- –†–ï–ì–ò–°–¢–†–ê–¶–ò–Ø -->
<div id="form-reg" style="display:none">
  <div class="aerr" id="err-reg"></div>
  <div class="fg">
    <div class="fl">–ò–º—è</div>
    <div class="fw">
      <span class="fi-ico"><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"/><circle cx="12" cy="7" r="4"/></svg></span>
      <input class="fi" type="text" id="r-name" placeholder="–í–∞—à–µ –∏–º—è" autocomplete="given-name">
    </div>
  </div>
  <div class="fg">
    <div class="fl">–¢–µ–ª–µ—Ñ–æ–Ω <span style="color:var(--red)">*</span></div>
    <div class="fw">
      <span class="fi-ico"><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07A19.5 19.5 0 0 1 4.69 12 19.79 19.79 0 0 1 1.61 3.38 2 2 0 0 1 3.58 1h3a2 2 0 0 1 2 1.72c.127.96.361 1.903.7 2.81a2 2 0 0 1-.45 2.11L7.91 8.96a16 16 0 0 0 6.29 6.29l1.32-1.32a2 2 0 0 1 2.11-.45c.907.339 1.85.573 2.81.7A2 2 0 0 1 22 16.92z"/></svg></span>
      <input class="fi" type="tel" id="r-phone" placeholder="+7 (999) 000-00-00" autocomplete="tel" inputmode="tel">
    </div>
    <div class="hint" id="h-phone"></div>
  </div>
  <div class="fg">
    <div class="fl">Email <span style="color:var(--red)">*</span></div>
    <div class="fw">
      <span class="fi-ico"><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="2" y="4" width="20" height="16" rx="2"/><path d="m22 7-10 7L2 7"/></svg></span>
      <input class="fi" type="email" id="r-email" placeholder="example@mail.ru" autocomplete="email" inputmode="email">
    </div>
    <div class="hint" id="h-email"></div>
  </div>
  <div class="fg">
    <div class="fl">–ü–∞—Ä–æ–ª—å <span style="color:var(--red)">*</span> <span style="font-size:10px;font-weight:400;text-transform:none">(–º–∏–Ω. 6 —Å–∏–º–≤–æ–ª–æ–≤)</span></div>
    <div class="fw">
      <span class="fi-ico"><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="11" width="18" height="11" rx="2"/><path d="M7 11V7a5 5 0 0 1 10 0v4"/></svg></span>
      <input class="fi" type="password" id="r-pass" placeholder="–ú–∏–Ω–∏–º—É–º 6 —Å–∏–º–≤–æ–ª–æ–≤" autocomplete="new-password">
      <button class="fi-eye" type="button" onclick="toggleEye('r-pass',this)"><svg width="17" height="17" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"/><circle cx="12" cy="12" r="3"/></svg></button>
    </div>
    <div class="sbar"><div class="sbar-fill" id="sbar-fill"></div></div>
    <div class="hint" id="h-pass"></div>
  </div>
  <div class="fg">
    <div class="fl">–ü–æ–≤—Ç–æ—Ä –ø–∞—Ä–æ–ª—è <span style="color:var(--red)">*</span></div>
    <div class="fw">
      <span class="fi-ico"><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M9 12l2 2 4-4"/><circle cx="12" cy="12" r="10"/></svg></span>
      <input class="fi" type="password" id="r-pass2" placeholder="–ü–æ–≤—Ç–æ—Ä–∏—Ç–µ –ø–∞—Ä–æ–ª—å" autocomplete="new-password">
    </div>
    <div class="hint" id="h-pass2"></div>
  </div>
  <button class="a-btn" id="btn-do-reg" onclick="doReg()">–°–û–ó–î–ê–¢–¨ –ê–ö–ö–ê–£–ù–¢</button>
</div>

<div class="a-legal">–ù–∞–∂–∏–º–∞—è –∫–Ω–æ–ø–∫—É, –≤—ã –ø—Ä–∏–Ω–∏–º–∞–µ—Ç–µ<br>—É—Å–ª–æ–≤–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–≥–æ —Å–æ–≥–ª–∞—à–µ–Ω–∏—è</div>
```

  </div>
</div>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
     –û–°–ù–û–í–ù–û–ï –ü–†–ò–õ–û–ñ–ï–ù–ò–ï
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->

<div id="app" class="screen">
  <div class="topbar">
    <div class="topbar-t" id="page-title">–ì–ª–∞–≤–Ω–∞—è</div>
    <div class="topav" id="topav" onclick="goTab('ambassadors')">A</div>
  </div>

  <!-- –ì–õ–ê–í–ù–ê–Ø -->

  <div id="page-home" class="page active">
    <div class="hero">
      <div class="hero-glow1"></div><div class="hero-glow2"></div>
      <div class="hero-cnt">
        <div>
          <div class="hero-title">INVESTAT</div>
          <div class="hero-sub">–ê–Ω–∞–ª–∏—Ç–∏–∫–∞ –¥–æ—Ö–æ–¥–Ω–æ–π –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç–∏</div>
        </div>
        <div class="hero-pills">
          <div class="hero-pill">–î–æ 67% –≥–æ–¥–æ–≤—ã—Ö</div>
          <div class="hero-pill">–†–∞–∑–±–æ—Ä—ã</div>
          <div class="hero-pill">–ö–µ–π—Å—ã</div>
          <div class="hero-pill">–ù–æ–≤–æ—Å—Ç–∏</div>
        </div>
      </div>
    </div>
    <div class="srch-wrap">
      <span class="srch-ico"><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"><circle cx="11" cy="11" r="8"/><path d="m21 21-4.35-4.35"/></svg></span>
      <input class="srch-inp" type="search" id="srch" placeholder="–ù–∞–π—Ç–∏ –º–∞—Ç–µ—Ä–∏–∞–ª—ã..." oninput="onSearch()">
    </div>
    <div class="chips" id="chips">
      <div class="chip on" onclick="setChip(this,'all')">–í—Å–µ</div>
      <div class="chip" onclick="setChip(this,'invest')">–ò–Ω–≤–µ—Å—Ç–∏—Ü–∏–∏</div>
      <div class="chip" onclick="setChip(this,'case')">–ö–µ–π—Å—ã</div>
      <div class="chip" onclick="setChip(this,'video')">–í–∏–¥–µ–æ</div>
      <div class="chip" onclick="setChip(this,'news')">–ù–æ–≤–æ—Å—Ç–∏</div>
      <div class="chip" onclick="setChip(this,'post')">–ü–æ—Å—Ç—ã</div>
    </div>
    <div id="search-res" style="display:none" class="pcards"></div>
    <div id="home-default">
      <div class="sec">–†–∞–∑–¥–µ–ª—ã</div>
      <div class="catgrid" id="catgrid"></div>
      <div class="sec" style="margin-top:20px">–†–µ—Ñ–µ—Ä–∞–ª—å–Ω–∞—è –ø—Ä–æ–≥—Ä–∞–º–º–∞</div>
      <div class="refb">
        <div class="rbico"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"/><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"/></svg></div>
        <div class="rbt">
          <div class="rbth">–ü—Ä–∏–≥–ª–∞—Å–∏ –¥—Ä—É–≥–∞</div>
          <div class="rbtl" id="hero-ref-link">–ó–∞–≥—Ä—É–∑–∫–∞...</div>
        </div>
        <div class="rbcp" id="hero-cp-btn" onclick="copyRef('hero-cp-btn','hero-ref-link')">
          <svg width="13" height="13" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="9" y="9" width="13" height="13" rx="2"/><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"/></svg>
          –ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å
        </div>
      </div>
      <div class="sec">–ü–æ—Å–ª–µ–¥–Ω–∏–µ –ø–æ—Å—Ç—ã</div>
      <div class="rlist" id="recent-list"></div>
    </div>
  </div>

  <!-- –°–û–û–ë–©–ï–°–¢–í–û -->

  <div id="page-community" class="page">
    <div class="clist" style="padding-top:12px">
      <div class="ci" onclick="openLink('https://t.me/+c4ekMHlWBbQzYjUy')">
        <div class="ciico" style="background:linear-gradient(135deg,#0a1855,#1e3a8a)"><svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2"><polygon points="3 11 22 2 13 21 11 13 3 11"/></svg></div>
        <div><div class="cit">INVESTAT</div><div class="cis">–û—Å–Ω–æ–≤–Ω–æ–π –∫–∞–Ω–∞–ª</div></div>
        <svg class="ciarr" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="m9 18 6-6-6-6"/></svg>
      </div>
      <div class="ci" onclick="toast('–°–∫–æ—Ä–æ –¥–æ—Å—Ç—É–ø–Ω–æ')">
        <div class="ciico" style="background:linear-gradient(135deg,#0f2040,#1a3060)"><svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2"><path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"/></svg></div>
        <div><div class="cit">–ß–∞—Ç –∏–Ω–≤–µ—Å—Ç–æ—Ä–æ–≤</div><div class="cis">–°–∫–æ—Ä–æ</div></div>
        <svg class="ciarr" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="m9 18 6-6-6-6"/></svg>
      </div>
    </div>
    <div class="csec">–ü–æ–¥–¥–µ—Ä–∂–∫–∞</div>
    <div class="clist">
      <div class="ci" onclick="toast('–û—Ç–∫—Ä—ã–≤–∞–µ–º...')">
        <div class="ciico" style="background:linear-gradient(135deg,#1a1a5a,#0f0f3a)"><svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="#818cf8" stroke-width="2"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/><polyline points="14 2 14 8 20 8"/></svg></div>
        <div><div class="cit">–ü—Ä–∞–≤–∏–ª–∞</div><div class="cis">–ò–∑—É—á–∏ –ø–µ—Ä–µ–¥ —É—á–∞—Å—Ç–∏–µ–º</div></div>
        <svg class="ciarr" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="m9 18 6-6-6-6"/></svg>
      </div>
      <div class="ci" onclick="toast('–û—Ç–∫—Ä—ã–≤–∞–µ–º...')">
        <div class="ciico" style="background:linear-gradient(135deg,#3a1800,#200e00)"><svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="#fb923c" stroke-width="2"><path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"/></svg></div>
        <div><div class="cit">–ü–æ–¥–¥–µ—Ä–∂–∫–∞</div><div class="cis">–ü–Ω‚Äì–ü—Ç 10:00‚Äì19:00</div></div>
        <svg class="ciarr" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="m9 18 6-6-6-6"/></svg>
      </div>
    </div>
  </div>

  <!-- –ü–†–û–ï–ö–¢–´ -->

  <div id="page-projects" class="page">
    <div style="padding:12px">
      <div class="pjitem" onclick="openLink('https://t.me/+c4ekMHlWBbQzYjUy')">
        <div class="pjav" style="background:linear-gradient(135deg,#0a1855,#1e3a8a)"><svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2"><polygon points="3 11 22 2 13 21 11 13 3 11"/></svg></div>
        <div><div class="pjt">–ö–∞–Ω–∞–ª INVESTAT</div><div class="pjs">–ê–Ω–∞–ª–∏—Ç–∏–∫–∞ –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç–∏</div></div>
        <span class="pjbdg">NEW</span>
      </div>
      <div class="pjitem" onclick="toast('–°–∫–æ—Ä–æ')">
        <div class="pjav" style="background:linear-gradient(135deg,#062a18,#0a3a22)"><svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2"><rect x="2" y="3" width="20" height="14" rx="2"/><line x1="8" y1="21" x2="16" y2="21"/><line x1="12" y1="17" x2="12" y2="21"/></svg></div>
        <div><div class="pjt">–ü–æ—Ä—Ç–∞–ª –ø—Ä–æ–µ–∫—Ç–æ–≤</div><div class="pjs">–†–µ–π—Ç–∏–Ω–≥ –¥–æ—Ö–æ–¥–Ω—ã—Ö –ø—Ä–æ–µ–∫—Ç–æ–≤</div></div>
      </div>
      <div class="pjitem" onclick="toast('–°–∫–æ—Ä–æ')">
        <div class="pjav" style="background:linear-gradient(135deg,#20082a,#2a1040)"><svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2"><path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M23 21v-2a4 4 0 0 0-3-3.87"/><path d="M16 3.13a4 4 0 0 1 0 7.75"/></svg></div>
        <div><div class="pjt">–ó–∞–∫—Ä—ã—Ç—ã–π –∫–ª—É–±</div><div class="pjs">–ù–µ—Ç–≤–æ—Ä–∫–∏–Ω–≥ –∏–Ω–≤–µ—Å—Ç–æ—Ä–æ–≤</div></div>
      </div>
    </div>
  </div>

  <!-- –ü–û–î–ë–û–†–ö–ò -->

  <div id="page-collections" class="page">
    <div class="pcards" id="coll-list" style="padding-top:12px"></div>
  </div>

  <!-- –ê–ú–ë–ê–°–°–ê–î–û–†–´ -->

  <div id="page-ambassadors" class="page">
    <div class="amhdr"><div class="amhdr-gl"></div>
      <div class="amhdr-t">–ê–º–±–∞—Å—Å–∞–¥–æ—Ä—ã</div>
      <div class="amhdr-s">–ü—Ä–∏–≥–ª–∞—à–∞–π ‚Äî —Ä–∞—Å—Ç–∏ –≤ —Ä–µ–π—Ç–∏–Ω–≥–µ</div>
    </div>
    <div class="amprof">
      <div class="ampt">
        <div class="amav" id="am-av">A</div>
        <div><div class="amname" id="am-name">‚Äî</div><div class="amlvl" id="am-lvl">üëã –ü—Ä–∏—è—Ç–µ–ª—å</div></div>
      </div>
      <div class="amstats">
        <div class="asb"><div class="asn" id="am-refs">0</div><div class="asl">–ü—Ä–∏–≥–ª–∞—à–µ–Ω–æ</div></div>
        <div class="asb"><div class="asn" id="am-favs">0</div><div class="asl">–ü–æ–¥–±–æ—Ä–æ–∫</div></div>
        <div class="asb"><div class="asn" id="am-pts">0</div><div class="asl">–ë–∞–ª–ª–æ–≤</div></div>
      </div>
    </div>
    <div class="sec">–£—Ä–æ–≤–Ω–∏</div>
    <div class="lvlrow" id="lvl-row"></div>
    <div class="pgbox">
      <div class="pgt" id="pg-title">–î–æ —Å–ª–µ–¥—É—é—â–µ–≥–æ —É—Ä–æ–≤–Ω—è</div>
      <div class="pgbar"><div class="pgfill" id="pg-fill"></div></div>
      <div class="pgs" id="pg-sub">–ü—Ä–∏–≥–ª–∞—à–∞–π—Ç–µ –¥—Ä—É–∑–µ–π</div>
    </div>
    <div class="amref">
      <div class="amrh"><svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"/><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"/></svg> –†–µ—Ñ–µ—Ä–∞–ª—å–Ω–∞—è —Å—Å—ã–ª–∫–∞</div>
      <div class="amrl" onclick="copyRef('am-cp','am-ref-link')">
        <span class="amrl-t" id="am-ref-link">–ó–∞–≥—Ä—É–∑–∫–∞...</span>
        <div class="amrl-cp" id="am-cp">
          <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="9" y="9" width="13" height="13" rx="2"/><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"/></svg>
          –ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å
        </div>
      </div>
    </div>
    <div class="sec">–†–µ–π—Ç–∏–Ω–≥ <span id="lb-live" style="font-size:10px;color:var(--acc);font-family:'Manrope',sans-serif;font-weight:600;text-transform:none;letter-spacing:0"></span></div>
    <div class="lb" id="lb"></div>
    <div class="amout" onclick="doLogout()">–í—ã–π—Ç–∏ –∏–∑ –∞–∫–∫–∞—É–Ω—Ç–∞</div>
  </div>

  <!-- –ù–∞–≤–∏–≥–∞—Ü–∏—è -->

  <nav class="bnav">
    <button class="ntab on" onclick="goTab('home',this)">
      <svg viewBox="0 0 24 24" fill="currentColor"><path d="M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8z"/></svg>–î–æ–º–æ–π
    </button>
    <button class="ntab" onclick="goTab('community',this)">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M23 21v-2a4 4 0 0 0-3-3.87"/><path d="M16 3.13a4 4 0 0 1 0 7.75"/></svg>–°–æ–æ–±—â–µ—Å—Ç–≤–æ
    </button>
    <button class="ntab" onclick="goTab('projects',this)">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="3" width="7" height="7" rx="1"/><rect x="14" y="3" width="7" height="7" rx="1"/><rect x="14" y="14" width="7" height="7" rx="1"/><rect x="3" y="14" width="7" height="7" rx="1"/></svg>–ü—Ä–æ–µ–∫—Ç—ã
    </button>
    <button class="ntab" onclick="goTab('collections',this)">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/></svg>–ü–æ–¥–±–æ—Ä–∫–∏
    </button>
    <button class="ntab" onclick="goTab('ambassadors',this)">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/></svg>–ü—Ä–æ—Ñ–∏–ª—å
    </button>
  </nav>
</div>

<!-- –ö–Ω–æ–ø–∫–∞ –∞–¥–º–∏–Ω–∞ -->

<button id="admin-fab" onclick="openAdmin()">
  <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12 20h9"/><path d="M16.5 3.5a2.121 2.121 0 0 1 3 3L7 19l-4 1 1-4L16.5 3.5z"/></svg>
</button>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
     –î–ï–¢–ê–õ–¨–ù–´–ô –ü–†–û–°–ú–û–¢–† –ü–û–°–¢–ê
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->

<div id="det">
  <div class="dhead">
    <button class="dback" onclick="closeDet()"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"><path d="m15 18-6-6 6-6"/></svg></button>
    <span class="dht" id="det-title">–ú–∞—Ç–µ—Ä–∏–∞–ª</span>
    <button class="favbtn" id="det-fav-btn" onclick="toggleDetFav()" style="color:#555">
      <svg id="det-fav-svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/></svg>
    </button>
  </div>
  <div class="dhero" id="det-hero">
    <div class="dhero-ov"></div>
    <svg id="det-hero-svg" width="110" height="110" viewBox="0 0 60 60" style="position:relative;z-index:1"></svg>
  </div>
  <div class="dcnt">
    <div id="det-badges" style="margin-bottom:10px"></div>
    <div class="dtitle" id="det-body-title"></div>
    <div class="dbody" id="det-body"></div>
    <div class="dtags" id="det-tags"></div>
    <div class="dactions">
      <a class="dbtn" id="det-watch" href="#" target="_blank">
        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polygon points="5 3 19 12 5 21 5 3"/></svg>–°–º–æ—Ç—Ä–µ—Ç—å
      </a>
      <a class="dbtn" id="det-consp" href="#" target="_blank">
        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/><polyline points="14 2 14 8 20 8"/></svg>–ö–æ–Ω—Å–ø–µ–∫—Ç
      </a>
    </div>
  </div>
</div>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
     –ê–î–ú–ò–ù –ü–ê–ù–ï–õ–¨
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->

<div id="admin-panel">
  <div class="adm-head">
    <button class="adm-back" onclick="closeAdmin()"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><path d="m15 18-6-6 6-6"/></svg></button>
    <span style="font-family:'Unbounded',sans-serif;font-size:14px;font-weight:700;flex:1">–ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å</span>
    <span style="font-size:10px;background:rgba(61,90,241,.2);color:#818cf8;padding:3px 8px;border-radius:6px;font-weight:700">ADMIN</span>
  </div>
  <div class="adm-tabs">
    <button class="adm-tab on" id="atab-posts" onclick="switchAdmTab('posts',this)">üìù –ü–æ—Å—Ç—ã</button>
    <button class="adm-tab" id="atab-users" onclick="switchAdmTab('users',this)">üë• –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏</button>
  </div>

  <!-- –í–∫–ª–∞–¥–∫–∞ –ø–æ—Å—Ç–æ–≤ -->

  <div id="adm-posts" style="padding:16px">
    <div style="background:var(--bg3);border-radius:14px;padding:16px;margin-bottom:16px;border:1px solid var(--brd)">
      <div style="font-size:13px;font-weight:700;color:var(--txt);margin-bottom:14px">‚ûï –ù–æ–≤—ã–π –ø–æ—Å—Ç</div>
      <div class="adm-field"><label>–ó–∞–≥–æ–ª–æ–≤–æ–∫ *</label><input id="ap-title" placeholder="–ó–∞–≥–æ–ª–æ–≤–æ–∫ –ø–æ—Å—Ç–∞"></div>
      <div class="adm-field"><label>–¢–µ–∫—Å—Ç * (–∏–∑ Telegram)</label><textarea id="ap-content" rows="5" placeholder="–í—Å—Ç–∞–≤—å —Ç–µ–∫—Å—Ç..."></textarea></div>
      <div style="display:grid;grid-template-columns:1fr 1fr;gap:10px">
        <div class="adm-field"><label>–ö–∞—Ç–µ–≥–æ—Ä–∏—è</label>
          <select id="ap-cat">
            <option>–ò–Ω–≤–µ—Å—Ç–∏—Ü–∏–∏</option><option>–ö–µ–π—Å—ã</option><option>–í–∏–¥–µ–æ</option>
            <option>–ê–Ω–∞–ª–∏—Ç–∏–∫–∞</option><option>–ù–æ–≤–æ—Å—Ç–∏</option><option>–û–±—É—á–µ–Ω–∏–µ</option>
          </select>
        </div>
        <div class="adm-field"><label>–¢–∏–ø</label>
          <select id="ap-type">
            <option value="invest">–ò–Ω–≤–µ—Å—Ç–∏—Ü–∏–∏</option><option value="case">–ö–µ–π—Å</option>
            <option value="video">–í–∏–¥–µ–æ</option><option value="post">–ü–æ—Å—Ç</option><option value="news">–ù–æ–≤–æ—Å—Ç—å</option>
          </select>
        </div>
      </div>
      <div class="adm-field"><label>–¢–µ–≥–∏ (—á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é)</label><input id="ap-tags" placeholder="—Å–æ—á–∏, –∞–ø–∞—Ä—Ç—ã"></div>
      <div class="adm-field"><label>–°—Å—ã–ª–∫–∞ –Ω–∞ –ø–æ—Å—Ç</label><input id="ap-link" value="https://t.me/+c4ekMHlWBbQzYjUy"></div>
      <div class="adm-field"><label>–ü–æ—Ä—è–¥–æ–∫ (–º–µ–Ω—å—à–µ = –≤—ã—à–µ)</label><input id="ap-order" type="number" placeholder="1"></div>
      <button class="adm-submit" id="adm-pub-btn" onclick="admPublish()">+ –û–ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å</button>
    </div>
    <div style="font-size:11px;font-weight:700;color:var(--txt2);text-transform:uppercase;letter-spacing:.06em;margin-bottom:10px">–í—Å–µ –ø–æ—Å—Ç—ã</div>
    <div id="adm-posts-list"></div>
  </div>

  <!-- –í–∫–ª–∞–¥–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π -->

  <div id="adm-users" style="padding:16px;display:none">
    <div style="font-size:11px;font-weight:700;color:var(--txt2);text-transform:uppercase;letter-spacing:.06em;margin-bottom:12px">–í—Å–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏</div>
    <div id="adm-users-list"></div>
  </div>
</div>

<!-- –¢–æ—Å—Ç -->

<div class="toast" id="toast-el"></div>

<script>
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// TELEGRAM INIT
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
(function(){
  try {
    var tg = window.Telegram && window.Telegram.WebApp;
    if (tg) {
      tg.ready();
      tg.expand();
      try { tg.setHeaderColor('#07070f'); } catch(e){}
      try { tg.setBackgroundColor('#07070f'); } catch(e){}
    }
    document.documentElement.style.background = '#07070f';
    document.body.style.background = '#07070f';
  } catch(e){}
})();

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// –ö–û–ù–°–¢–ê–ù–¢–´ –ò –î–ê–ù–ù–´–ï
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
var ADMIN_IDS = ['5996401983','240326047']; // —Ç–≤–æ–π ID –∏ –ø–∞–ø—ã

var CAT_META = {
  '–ò–Ω–≤–µ—Å—Ç–∏—Ü–∏–∏': {ico:'i-coin',  bg:'linear-gradient(135deg,#0a1855,#1e3a8a)'},
  '–ö–µ–π—Å—ã':      {ico:'i-build', bg:'linear-gradient(135deg,#1a0840,#3a1a80)'},
  '–í–∏–¥–µ–æ':      {ico:'i-play',  bg:'linear-gradient(135deg,#0a3020,#1a6040)'},
  '–ê–Ω–∞–ª–∏—Ç–∏–∫–∞':  {ico:'i-chart', bg:'linear-gradient(135deg,#301000,#602008)'},
  '–ù–æ–≤–æ—Å—Ç–∏':    {ico:'i-news',  bg:'linear-gradient(135deg,#002030,#004060)'},
  '–û–±—É—á–µ–Ω–∏–µ':   {ico:'i-edu',   bg:'linear-gradient(135deg,#1a0820,#401060)'},
};

var LEVELS = [
  {name:'–ü—Ä–∏—è—Ç–µ–ª—å', req:0,  emoji:'üëã'},
  {name:'–ü–∞—Ä—Ç–Ω—ë—Ä',  req:3,  emoji:'ü§ù'},
  {name:'–≠–∫—Å–ø–µ—Ä—Ç',  req:10, emoji:'‚≠ê'},
  {name:'–¢–æ–ø',      req:25, emoji:'üèÜ'},
];

var COLORS = ['#0a1855','#1a0840','#0a3020','#301000','#002030','#1a0820'];

var POSTS_DEFAULT = [
  {id:'d1',title:'–î–æ—Ö–æ–¥–Ω–∞—è –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç—å: –ø—Ä–æ–µ–∫—Ç—ã —Å 40‚Äì67% –≥–æ–¥–æ–≤—ã—Ö',content:'–ü–æ—Ä—Ç–∞–ª INVESTAT —Å–æ–±—Ä–∞–ª –ª—É—á—à–∏–µ –ø—Ä–æ–µ–∫—Ç—ã —Å –ø–æ–¥—Ç–≤–µ—Ä–∂–¥—ë–Ω–Ω—ã–º–∏ –ø–æ–∫–∞–∑–∞—Ç–µ–ª—è–º–∏.\n\n–ö–∞–∫ –æ—Ç–±–∏—Ä–∞–µ–º –ø—Ä–æ–µ–∫—Ç—ã:\n‚Ä¢ –Æ—Ä–∏–¥–∏—á–µ—Å–∫–∞—è —á–∏—Å—Ç–æ—Ç–∞ –æ–±—ä–µ–∫—Ç–∞\n‚Ä¢ –ê–Ω–∞–ª–∏–∑ —Ñ–∏–Ω–∞–Ω—Å–æ–≤–æ–π –º–æ–¥–µ–ª–∏ –∑–∞—Å—Ç—Ä–æ–π—â–∏–∫–∞\n‚Ä¢ –ù–µ–∑–∞–≤–∏—Å–∏–º–∞—è –æ—Ü–µ–Ω–∫–∞ —Ä—ã–Ω–æ—á–Ω–æ–π —Å—Ç–æ–∏–º–æ—Å—Ç–∏\n‚Ä¢ –ò—Å—Ç–æ—Ä–∏—è –≤—ã–ø–ª–∞—Ç –∏–Ω–≤–µ—Å—Ç–æ—Ä–∞–º\n\n–¢–æ–ø-–ø—Ä–æ–µ–∫—Ç—ã:\n1. –ê–ø–∞—Ä—Ç-–æ—Ç–µ–ª—å –≤ –°–æ—á–∏ ‚Äî 67% –≥–æ–¥–æ–≤—ã—Ö\n2. –ö–æ—Ç—Ç–µ–¥–∂–Ω—ã–π –ø–æ—Å—ë–ª–æ–∫ –ú–û ‚Äî 54% –≥–æ–¥–æ–≤—ã—Ö\n3. –¢–æ—Ä–≥–æ–≤—ã–µ –ø–ª–æ—â–∞–¥–∏ –°–ü–± ‚Äî 41% –≥–æ–¥–æ–≤—ã—Ö',cat:'–ò–Ω–≤–µ—Å—Ç–∏—Ü–∏–∏',type:'invest',tags:'–Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç—å,–¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å',tgLink:'https://t.me/+c4ekMHlWBbQzYjUy',order:1},
  {id:'d2',title:'–ö–µ–π—Å: 2 400 000 ‚ÇΩ –∑–∞ 18 –º–µ—Å—è—Ü–µ–≤',content:'–°—Ç–∞—Ä—Ç–æ–≤—ã–π –∫–∞–ø–∏—Ç–∞–ª: 3 600 000 ‚ÇΩ. –û–±—ä–µ–∫—Ç: –∞–ø–∞—Ä—Ç–∞–º–µ–Ω—Ç—ã –≤ –°–æ—á–∏. –°—Ä–æ–∫: 18 –º–µ—Å—è—Ü–µ–≤.\n\nüí∞ –ò—Ç–æ–≥–æ –ø—Ä–∏–±—ã–ª–∏: 2 400 000 ‚ÇΩ\nüî¢ –î–æ—Ö–æ–¥–Ω–æ—Å—Ç—å: 44,4% –≥–æ–¥–æ–≤—ã—Ö',cat:'–ö–µ–π—Å—ã',type:'case',tags:'–∫–µ–π—Å,–°–æ—á–∏,—Ä–µ–∑—É–ª—å—Ç–∞—Ç',tgLink:'https://t.me/+c4ekMHlWBbQzYjUy',order:2},
  {id:'d3',title:'–ê–Ω–∞–ª–∏—Ç–∏–∫–∞ —Ä—ã–Ω–∫–∞ –¥–æ—Ö–æ–¥–Ω–æ–π –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç–∏ 2025',content:'–ë–æ–ª—å—à–æ–π –∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏–π –æ–±–∑–æ—Ä –Ω–∞ 2025 –≥–æ–¥.\n\nüìà –ì–ª–∞–≤–Ω—ã–µ —Ç—Ä–µ–Ω–¥—ã:\n1. –ê–ø–∞—Ä—Ç-–æ—Ç–µ–ª–∏ –≤ —Ç—É—Ä–∏—Å—Ç–∏—á–µ—Å–∫–∏—Ö –∑–æ–Ω–∞—Ö ‚Äî —Ä–æ—Å—Ç —Å–ø—Ä–æ—Å–∞ +34%\n2. –ö–æ–º–º–µ—Ä—á–µ—Å–∫–∞—è –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç—å –≤ —Ä–µ–≥–∏–æ–Ω–∞—Ö ‚Äî –Ω–µ–¥–æ–æ—Ü–µ–Ω—ë–Ω–Ω—ã–π —Å–µ–≥–º–µ–Ω—Ç\n3. –ö—Ä–∞—É–¥–ª–µ–Ω–¥–∏–Ω–≥ ‚Äî –æ–±—ä—ë–º —Ä—ã–Ω–∫–∞ —É–¥–≤–æ–∏–ª—Å—è',cat:'–ê–Ω–∞–ª–∏—Ç–∏–∫–∞',type:'post',tags:'–∞–Ω–∞–ª–∏—Ç–∏–∫–∞,2025',tgLink:'https://t.me/+c4ekMHlWBbQzYjUy',order:3},
  {id:'d4',title:'–í–∏–¥–µ–æ: –ó–∞–∫—Ä—ã—Ç—ã–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è ‚Äî –∫–∞–∫ –ø–æ–ª—É—á–∏—Ç—å –¥–æ—Å—Ç—É–ø',content:'–†–∞—Å—Å–∫–∞–∑—ã–≤–∞—é, –∫–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å–∏—Å—Ç–µ–º–∞ –∑–∞–∫—Ä—ã—Ç—ã—Ö –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π INVESTAT.\n\n–ß—Ç–æ –≤–Ω—É—Ç—Ä–∏:\n‚Äî –ö–∞–∫ —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç—Å—è –±–∞–∑–∞ –ø—Ä–æ–µ–∫—Ç–æ–≤\n‚Äî –†–µ–∞–ª—å–Ω—ã–µ –∏—Å—Ç–æ—Ä–∏–∏ –∏–Ω–≤–µ—Å—Ç–æ—Ä–æ–≤\n‚Äî –ü–æ—à–∞–≥–æ–≤—ã–π –ø—Ä–æ—Ü–µ—Å—Å –≤—Ö–æ–¥–∞',cat:'–í–∏–¥–µ–æ',type:'video',tags:'–≤–∏–¥–µ–æ,–æ–±—É—á–µ–Ω–∏–µ',tgLink:'https://t.me/+c4ekMHlWBbQzYjUy',order:4},
];

// –î–æ–±–∞–≤–ª—è–µ–º –∏–∫–æ–Ω–∫–∏ –∏ —Ñ–æ–Ω –∏–∑ CAT_META
POSTS_DEFAULT.forEach(function(p) {
  var m = CAT_META[p.cat] || CAT_META['–ò–Ω–≤–µ—Å—Ç–∏—Ü–∏–∏'];
  p.ico = m.ico; p.bg = m.bg;
});

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// –°–û–°–¢–û–Ø–ù–ò–ï
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
var CU   = null;       // —Ç–µ–∫—É—â–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
var FAVS = {};         // –∏–∑–±—Ä–∞–Ω–Ω—ã–µ –ø–æ—Å—Ç—ã
var POSTS = [];        // —Ç–µ–∫—É—â–∏–µ –ø–æ—Å—Ç—ã
var CHIP  = 'all';     // –∞–∫—Ç–∏–≤–Ω—ã–π —Ñ–∏–ª—å—Ç—Ä
var OPEN_POST = null;  // –æ—Ç–∫—Ä—ã—Ç—ã–π –ø–æ—Å—Ç
var TG_USER = null;    // –¥–∞–Ω–Ω—ã–µ Telegram

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// STORAGE
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
function lsGet(k) { try { return JSON.parse(localStorage.getItem(k)||'null'); } catch(e) { return null; } }
function lsSet(k,v) { try { localStorage.setItem(k, JSON.stringify(v)); } catch(e){} }
function lsDel(k) { try { localStorage.removeItem(k); } catch(e){} }

function getUsers()   { return lsGet('iv_users') || {}; }
function saveUsers(u) { lsSet('iv_users', u); }
function getSess()    { return lsGet('iv_sess'); }
function saveSess(u)  { lsSet('iv_sess', u); }
function clearSess()  { lsDel('iv_sess'); }
function getFavs(id)  { return lsGet('iv_favs_'+id) || {}; }
function saveFavs(id,f) { lsSet('iv_favs_'+id, f); }

function hashPw(s) {
  var h = 0;
  for (var i = 0; i < s.length; i++) h = Math.imul(31,h) + s.charCodeAt(i) | 0;
  return h.toString(36);
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// FIREBASE HELPERS
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
function waitFB(cb, n) {
  n = n || 0;
  if (window.FB_READY) { cb(); return; }
  if (n > 40) { cb(); return; }
  setTimeout(function(){ waitFB(cb, n+1); }, 150);
}

function fbSaveUser(u) {
  if (!window.FB_READY || !u) return;
  try {
    var tg = TG_USER || {};
    var ref = window.fsDoc(window.FS, 'users', String(u.id));
    window.fsSetDoc(ref, {
      id:        String(u.id),
      name:      u.name || '–ò–Ω–≤–µ—Å—Ç–æ—Ä',
      username:  u.username || tg.username || '',
      phone:     u.phone || '',
      email:     u.email || '',
      refs:      u.refs  || 0,
      pts:       u.pts   || 0,
      col:       u.col   || '#3d5af1',
      platform:  /iPhone|iPad/.test(navigator.userAgent) ? 'iOS' : /Android/.test(navigator.userAgent) ? 'Android' : 'Web',
      lastSeen:  new Date().toISOString(),
      updatedAt: window.fsTs(),
    }, { merge: true }).catch(function(e){ console.warn('fbSaveUser', e); });
  } catch(e) { console.warn(e); }
}

function fbSyncUser() {
  if (!window.FB_READY || !CU) return;
  var ref = window.fsDoc(window.FS, 'users', String(CU.id));
  window.fsGetDoc(ref).then(function(snap) {
    if (!snap.exists()) return;
    var d = snap.data();
    CU.refs = d.refs || CU.refs || 0;
    CU.pts  = d.pts  || CU.pts  || 0;
    saveSess(CU);
    updateUI();
  }).catch(function(){});
}

function fbAddRef(inviterId, newUserId) {
  if (!window.FB_READY) return;
  var cleanId = String(inviterId).replace('ref_','').replace('tg','');
  // –ò—â–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è ‚Äî –ø—Ä–æ–±—É–µ–º —Å –∏ –±–µ–∑ tg-–ø—Ä–µ—Ñ–∏–∫—Å–∞
  var tries = [cleanId, 'tg'+cleanId];
  var found = null;
  var idx = 0;
  function tryNext() {
    if (idx >= tries.length) {
      console.warn('fbAddRef: –Ω–µ –Ω–∞–π–¥–µ–Ω', cleanId);
      return;
    }
    var tryId = tries[idx++];
    window.fsGetDoc(window.fsDoc(window.FS,'users',tryId)).then(function(snap) {
      if (snap.exists()) {
        found = tryId;
        doAddRef(found, newUserId);
      } else {
        tryNext();
      }
    }).catch(function(){ tryNext(); });
  }
  tryNext();
}

function doAddRef(docId, newUserId) {
  var ref = window.fsDoc(window.FS, 'users', docId);
  window.fsGetDoc(ref).then(function(snap) {
    var d = snap.exists() ? snap.data() : {};
    var already = (d.refedUsers || []);
    var nu = String(newUserId).replace('tg','');
    for (var i = 0; i < already.length; i++) {
      if (String(already[i]).replace('tg','') === nu) {
        console.log('—Ä–µ—Ñ–µ—Ä–∞–ª —É–∂–µ –∑–∞—Å—á–∏—Ç–∞–Ω');
        return;
      }
    }
    window.fsUpdate(ref, {
      refs:       window.fsInc(1),
      pts:        window.fsInc(100),
      refedUsers: window.fsUnion(nu),
    }).then(function(){
      console.log('‚úÖ –†–µ—Ñ–µ—Ä–∞–ª –∑–∞—Å—á–∏—Ç–∞–Ω!');
      // –ï—Å–ª–∏ —ç—Ç–æ —Ç–µ–∫—É—â–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å ‚Äî –æ–±–Ω–æ–≤–ª—è–µ–º UI
      var cleanDoc = String(docId).replace('tg','');
      if (CU && String(CU.id).replace('tg','') === cleanDoc) {
        CU.refs = (CU.refs || 0) + 1;
        CU.pts  = (CU.pts  || 0) + 100;
        saveSess(CU);
        updateUI();
        toast('üéâ +1 —Ä–µ—Ñ–µ—Ä–∞–ª –∑–∞—Å—á–∏—Ç–∞–Ω!');
      }
    }).catch(function(e){ console.warn(e); });
  });
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// –ü–û–°–¢–´
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
var _postsUnsub = null;

function loadPosts() {
  if (!window.FB_READY) {
    POSTS = POSTS_DEFAULT.slice();
    renderHome();
    return;
  }
  if (_postsUnsub) { try{ _postsUnsub(); }catch(e){} _postsUnsub = null; }
  try {
    _postsUnsub = window.fsSnap(window.fsColl(window.FS,'posts'), function(snap) {
      var loaded = [];
      snap.forEach(function(d) {
        var p = d.data();
        if (p.published === false) return;
        var m = CAT_META[p.cat] || CAT_META['–ò–Ω–≤–µ—Å—Ç–∏—Ü–∏–∏'];
        loaded.push({
          id:      d.id,
          title:   p.title   || '–ë–µ–∑ –Ω–∞–∑–≤–∞–Ω–∏—è',
          content: p.content || '',
          cat:     p.cat     || '–ò–Ω–≤–µ—Å—Ç–∏—Ü–∏–∏',
          tags:    p.tags    || '',
          type:    p.type    || 'post',
          ico:     p.ico     || m.ico,
          bg:      p.bg      || m.bg,
          order:   typeof p.order === 'number' ? p.order : 99,
          tgLink:  p.tgLink  || 'https://t.me/+c4ekMHlWBbQzYjUy',
          tgConsp: p.tgConsp || 'https://t.me/+c4ekMHlWBbQzYjUy',
        });
      });
      POSTS = loaded.length > 0
        ? loaded.sort(function(a,b){ return a.order - b.order; })
        : POSTS_DEFAULT.slice();
      var hp = document.getElementById('page-home');
      if (hp && hp.classList.contains('active')) renderHome();
    }, function(e){ console.warn(e); POSTS = POSTS_DEFAULT.slice(); });
  } catch(e) {
    POSTS = POSTS_DEFAULT.slice();
  }
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// BOOT ‚Äî –≥–ª–∞–≤–Ω–∞—è —Ç–æ—á–∫–∞ –≤—Ö–æ–¥–∞
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
function boot() {
  // –ß–∏—Ç–∞–µ–º –¥–∞–Ω–Ω—ã–µ Telegram
  try {
    var tg = window.Telegram && window.Telegram.WebApp;
    if (tg && tg.initDataUnsafe) {
      var tgu = tg.initDataUnsafe.user;
      if (tgu) {
        TG_USER = {
          id:       String(tgu.id),
          name:     [tgu.first_name, tgu.last_name].filter(Boolean).join(' ') || tgu.username || '–ò–Ω–≤–µ—Å—Ç–æ—Ä',
          username: tgu.username || '',
        };
        var rnEl = document.getElementById('r-name');
        if (rnEl) rnEl.value = TG_USER.name;
      }
      var sp = tg.initDataUnsafe.start_param || '';
      if (sp && sp.indexOf('ref_') === 0) {
        var rid = sp.replace('ref_','').replace('tg','');
        if (rid.length > 2) {
          lsSet('ref_from', rid);
          console.log('–†–µ—Ñ–µ—Ä–∞–ª –æ—Ç:', rid);
        }
      }
    }
  } catch(e){}

  // –ï—Å—Ç—å —Å–µ—Å—Å–∏—è?
  var sess = getSess();
  if (sess && sess.id) {
    CU   = sess;
    FAVS = getFavs(CU.id);
    launch();
    return;
  }

  // –ù–µ—Ç —Å–µ—Å—Å–∏–∏ ‚Äî —ç–∫—Ä–∞–Ω –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
  showScreen('auth');
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// –ü–ï–†–ï–ö–õ–Æ–ß–ï–ù–ò–ï –í–ö–õ–ê–î–û–ö –ê–í–¢–û–†–ò–ó–ê–¶–ò–ò
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
function showTab(tab) {
  var isLogin = (tab === 'login');
  document.getElementById('btn-login').className = 'seg-btn' + (isLogin ? ' on' : '');
  document.getElementById('btn-reg').className   = 'seg-btn' + (isLogin ? '' : ' on');
  document.getElementById('form-login').style.display = isLogin ? 'block' : 'none';
  document.getElementById('form-reg').style.display   = isLogin ? 'none'  : 'block';
  // –°–±—Ä–∞—Å—ã–≤–∞–µ–º –æ—à–∏–±–∫–∏
  hideErr('err-login');
  hideErr('err-reg');
}

function showErr(id, msg) {
  var el = document.getElementById(id);
  if (!el) return;
  el.textContent = msg;
  el.className = 'aerr show';
}
function hideErr(id) {
  var el = document.getElementById(id);
  if (el) { el.textContent = ''; el.className = 'aerr'; }
}

function toggleEye(inputId, btn) {
  var inp = document.getElementById(inputId);
  if (!inp) return;
  inp.type = inp.type === 'password' ? 'text' : 'password';
  btn.style.opacity = inp.type === 'text' ? '0.7' : '0.3';
}

// –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä —Å–∏–ª—ã –ø–∞—Ä–æ–ª—è –ø—Ä–∏ –≤–≤–æ–¥–µ
document.addEventListener('DOMContentLoaded', function() {
  var rp = document.getElementById('r-pass');
  if (rp) rp.oninput = function() {
    var v = rp.value;
    var s = 0;
    if (v.length >= 6) s++;
    if (v.length >= 10) s++;
    if (/\d/.test(v)) s++;
    if (/[A-Z–ê-–Ø]/.test(v)) s++;
    var fill = document.getElementById('sbar-fill');
    if (fill) {
      fill.style.width = (s * 25) + '%';
      fill.style.background = ['#e03050','#e8640a','#d4a011','#0baa6e'][s-1] || '#e03050';
    }
    var h = document.getElementById('h-pass');
    if (h) {
      if (!v) { h.textContent=''; h.className='hint'; return; }
      if (v.length < 6) { h.textContent='–ú–∏–Ω–∏–º—É–º 6 —Å–∏–º–≤–æ–ª–æ–≤'; h.className='hint er'; return; }
      h.textContent = ['','–°–ª–∞–±—ã–π','–°—Ä–µ–¥–Ω–∏–π','–•–æ—Ä–æ—à–∏–π','–û—Ç–ª–∏—á–Ω—ã–π'][s] || '–°–ª–∞–±—ã–π';
      h.className = 'hint ' + (s >= 3 ? 'ok' : 'er');
    }
  };
});

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// –í–•–û–î
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
function doLogin() {
  hideErr('err-login');
  var email = (document.getElementById('l-email').value||'').trim().toLowerCase();
  var pass  = document.getElementById('l-pass').value || '';

  if (!email) { showErr('err-login', '–í–≤–µ–¥–∏—Ç–µ email'); return; }
  if (!pass)  { showErr('err-login', '–í–≤–µ–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å'); return; }

  var users = getUsers();
  var found = null;
  var keys = Object.keys(users);
  for (var i = 0; i < keys.length; i++) {
    if (users[keys[i]].email === email) { found = users[keys[i]]; break; }
  }

  if (!found) { showErr('err-login', 'Email –Ω–µ –Ω–∞–π–¥–µ–Ω. –°–Ω–∞—á–∞–ª–∞ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ—Å—å.'); return; }
  if (found.ph !== hashPw(pass)) { showErr('err-login', '–ù–µ–≤–µ—Ä–Ω—ã–π –ø–∞—Ä–æ–ª—å'); return; }

  // –ü—Ä–∏–º–µ–Ω—è–µ–º TG ID –µ—Å–ª–∏ –µ—Å—Ç—å
  if (TG_USER && TG_USER.id && found.id !== TG_USER.id) {
    delete users[found.id];
    found.id = TG_USER.id;
    found.name = TG_USER.name || found.name;
    found.username = TG_USER.username || found.username || '';
    users[TG_USER.id] = found;
    saveUsers(users);
  }

  CU   = found;
  FAVS = getFavs(CU.id);
  saveSess(CU);
  waitFB(function(){ fbSaveUser(CU); });
  launch();
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// –†–ï–ì–ò–°–¢–†–ê–¶–ò–Ø
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
function doReg() {
  hideErr('err-reg');

  var name  = (document.getElementById('r-name').value||'').trim();
  var phone = (document.getElementById('r-phone').value||'').replace(/\D/g,'');
  var email = (document.getElementById('r-email').value||'').trim().toLowerCase();
  var pass  = document.getElementById('r-pass').value  || '';
  var pass2 = document.getElementById('r-pass2').value || '';

  // –í–∞–ª–∏–¥–∞—Ü–∏—è
  if (!phone || phone.length < 10) { showErr('err-reg', '–í–≤–µ–¥–∏—Ç–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π —Ç–µ–ª–µ—Ñ–æ–Ω'); return; }
  if (!email || !/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email)) { showErr('err-reg', '–í–≤–µ–¥–∏—Ç–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π email'); return; }
  if (!pass || pass.length < 6) { showErr('err-reg', '–ü–∞—Ä–æ–ª—å –º–∏–Ω–∏–º—É–º 6 —Å–∏–º–≤–æ–ª–æ–≤'); return; }
  if (pass !== pass2) { showErr('err-reg', '–ü–∞—Ä–æ–ª–∏ –Ω–µ —Å–æ–≤–ø–∞–¥–∞—é—Ç'); return; }

  var users = getUsers();

  // –ü—Ä–æ–≤–µ—Ä–∫–∞ email
  var ks = Object.keys(users);
  for (var i = 0; i < ks.length; i++) {
    if (users[ks[i]].email === email) { showErr('err-reg', '–≠—Ç–æ—Ç email —É–∂–µ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω'); return; }
  }

  // ID: Telegram ID –∏–ª–∏ timestamp
  var id  = (TG_USER && TG_USER.id) ? String(TG_USER.id) : String(Date.now());
  var col = COLORS[Math.floor(Math.random() * COLORS.length)];
  var existing = users[id] || {};

  var u = {
    id:       id,
    name:     name || (TG_USER && TG_USER.name) || '–ò–Ω–≤–µ—Å—Ç–æ—Ä',
    username: (TG_USER && TG_USER.username) || '',
    phone:    phone,
    email:    email,
    ph:       hashPw(pass),
    refs:     existing.refs || 0,
    pts:      existing.pts  || 0,
    col:      existing.col  || col,
  };

  users[id] = u;
  saveUsers(users);
  CU   = u;
  FAVS = {};
  saveSess(CU);

  // –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤ Firebase —Ñ–æ–Ω–æ–≤–æ
  waitFB(function(){ fbSaveUser(CU); });

  // –†–µ—Ñ–µ—Ä–∞–ª
  var refFrom = lsGet('ref_from');
  if (refFrom && String(refFrom) !== String(id).replace('tg','')) {
    waitFB(function(){ fbAddRef(refFrom, id); });
    lsDel('ref_from');
  }

  launch();
  toast('–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ INVESTAT! üéâ');
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// –í–´–•–û–î
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
function doLogout() {
  CU   = null;
  FAVS = {};
  clearSess();
  showScreen('auth');
  showTab('login');
  document.getElementById('l-email').value = '';
  document.getElementById('l-pass').value  = '';
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// –ó–ê–ü–£–°–ö –ü–†–ò–õ–û–ñ–ï–ù–ò–Ø
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
function launch() {
  showScreen('app');
  POSTS = POSTS_DEFAULT.slice(); // —Å–Ω–∞—á–∞–ª–∞ –¥–µ—Ñ–æ–ª—Ç–Ω—ã–µ
  updateUI();
  renderHome();
  renderCollections();
  renderLevels();
  checkAdminFab();
  waitFB(function(){
    loadPosts();
    listenLeaderboard();
    fbSyncUser();
  });
}

function showScreen(id) {
  document.getElementById('auth').className = 'screen' + (id==='auth' ? ' active' : '');
  document.getElementById('app').className  = 'screen' + (id==='app'  ? ' active' : '');
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// UI UPDATE
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
var LEVELS_DATA = LEVELS;

function curLevel() {
  var refs = CU ? (CU.refs || 0) : 0;
  var lv = LEVELS[0];
  for (var i = 0; i < LEVELS.length; i++) if (refs >= LEVELS[i].req) lv = LEVELS[i];
  return lv;
}

function updateUI() {
  if (!CU) return;
  var init = (CU.name || 'I')[0].toUpperCase();
  var topav = document.getElementById('topav');
  if (topav) { topav.textContent = init; topav.style.background = 'linear-gradient(135deg,'+( CU.col||'#3d5af1')+'cc,'+( CU.col||'#3d5af1')+')'; }
  var amav = document.getElementById('am-av');
  if (amav) { amav.textContent = init; amav.style.background = CU.col || '#3d5af1'; }
  setEl('am-name', CU.name || '–ò–Ω–≤–µ—Å—Ç–æ—Ä');
  var lv = curLevel();
  setEl('am-lvl',  lv.emoji + ' ' + lv.name);
  setEl('am-refs', CU.refs || 0);
  setEl('am-favs', Object.keys(FAVS).length);
  setEl('am-pts',  CU.pts  || 0);

  // –†–µ—Ñ–µ—Ä–∞–ª—å–Ω–∞—è —Å—Å—ã–ª–∫–∞
  var refId = String(CU.id).replace('tg','');
  var refUrl = 'https://t.me/navigationinvestat_bot?startapp=ref_' + refId;
  setEl('am-ref-link', refUrl);
  setEl('hero-ref-link', refUrl);

  // –ü—Ä–æ–≥—Ä–µ—Å—Å
  var refs = CU.refs || 0;
  var lvIdx = LEVELS.indexOf(lv);
  var next = LEVELS[lvIdx+1];
  if (next) {
    var pct = Math.min(Math.round((refs-lv.req)/(next.req-lv.req)*100), 100);
    setTimeout(function(){ var el=document.getElementById('pg-fill'); if(el) el.style.width=pct+'%'; }, 400);
    setEl('pg-title', '–î–æ —É—Ä–æ–≤–Ω—è ¬´' + next.name + '¬ª');
    setEl('pg-sub', '–ï—â—ë ' + (next.req - refs) + ' ' + declRefs(next.req - refs));
  } else {
    setTimeout(function(){ var el=document.getElementById('pg-fill'); if(el) el.style.width='100%'; }, 400);
    setEl('pg-title', '–ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —É—Ä–æ–≤–µ–Ω—å!');
    setEl('pg-sub',   '–í—ã –≤ —Ç–æ–ø–µ –∞–º–±–∞—Å—Å–∞–¥–æ—Ä–æ–≤ üèÜ');
  }
}

function declRefs(n) {
  if (n % 100 >= 11 && n % 100 <= 19) return '–ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏–π';
  var r = n % 10;
  if (r === 1) return '–ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏–µ';
  if (r >= 2 && r <= 4) return '–ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏—è';
  return '–ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏–π';
}

function setEl(id, val) {
  var el = document.getElementById(id);
  if (el) el.textContent = val;
}

function renderLevels() {
  var refs = CU ? (CU.refs||0) : 0;
  var html = '';
  for (var i = 0; i < LEVELS.length; i++) {
    var l = LEVELS[i];
    html += '<div class="lvlcard' + (refs >= l.req ? ' active' : '') + '">'
      + '<div class="lvl-e">' + l.emoji + '</div>'
      + '<div class="lvl-n">' + l.name  + '</div>'
      + '<div class="lvl-r">' + (l.req === 0 ? '–°—Ç–∞—Ä—Ç' : l.req + ' –ø—Ä–∏–≥–ª–∞—à.') + '</div>'
      + '</div>';
  }
  setElHTML('lvl-row', html);
}

function setElHTML(id, html) {
  var el = document.getElementById(id);
  if (el) el.innerHTML = html;
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// –ù–ê–í–ò–ì–ê–¶–ò–Ø
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
var TAB_TITLES = {home:'–ì–ª–∞–≤–Ω–∞—è',community:'–°–æ–æ–±—â–µ—Å—Ç–≤–æ',projects:'–ü—Ä–æ–µ–∫—Ç—ã',collections:'–ü–æ–¥–±–æ—Ä–∫–∏',ambassadors:'–ü—Ä–æ—Ñ–∏–ª—å'};

function goTab(name, btn) {
  document.querySelectorAll('.page').forEach(function(p){ p.classList.remove('active'); });
  document.querySelectorAll('.ntab').forEach(function(t){ t.classList.remove('on'); });
  var pg = document.getElementById('page-'+name);
  if (pg) pg.classList.add('active');
  if (btn && btn.classList) btn.classList.add('on');
  else {
    // –≤—ã–∑–æ–≤ –±–µ–∑ –∫–Ω–æ–ø–∫–∏ ‚Äî –Ω–∞–π–¥—ë–º –∫–Ω–æ–ø–∫—É –ø–æ –∏–Ω–¥–µ–∫—Å—É
    var tabs = ['home','community','projects','collections','ambassadors'];
    var idx = tabs.indexOf(name);
    var btns = document.querySelectorAll('.ntab');
    if (btns[idx]) btns[idx].classList.add('on');
  }
  setEl('page-title', TAB_TITLES[name] || '');
  if (name === 'collections') renderCollections();
  if (name === 'ambassadors') { updateUI(); renderLevels(); }
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// –ì–õ–ê–í–ù–ê–Ø –°–¢–†–ê–ù–ò–¶–ê
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
function renderHome() {
  // –ö–∞—Ç–µ–≥–æ—Ä–∏–∏
  var cats = {};
  for (var i = 0; i < POSTS.length; i++) {
    var p = POSTS[i];
    if (!cats[p.cat]) cats[p.cat] = Object.assign({}, CAT_META[p.cat] || CAT_META['–ò–Ω–≤–µ—Å—Ç–∏—Ü–∏–∏'], {cnt:0});
    cats[p.cat].cnt++;
  }
  var catHtml = '';
  var catKeys = Object.keys(cats);
  for (var i = 0; i < catKeys.length; i++) {
    var cn = catKeys[i];
    var cm = cats[cn];
    catHtml += '<div class="ccard" style="background:'+cm.bg+'" onclick="filterCat(\''+cn+'\')"><div class="ccard-ov"></div>'
      +'<div class="ccard-ico"><svg width="36" height="36" viewBox="0 0 60 60"><use href="#'+cm.ico+'" color="white"/></svg></div>'
      +'<div class="ccard-body"><div class="ccard-cnt">'+cm.cnt+' –º–∞—Ç–µ—Ä.</div><div class="ccard-name">'+cn+'</div></div></div>';
  }
  setElHTML('catgrid', catHtml);

  // –ü–æ—Å–ª–µ–¥–Ω–∏–µ –ø–æ—Å—Ç—ã
  var rl = document.getElementById('recent-list');
  if (rl) {
    var html = '';
    var slice = POSTS.slice(0,5);
    for (var i = 0; i < slice.length; i++) {
      var p = slice[i];
      var sid = String(p.id);
      html += '<div class="rpost" onclick="openPost(\''+sid+'\')"><div class="rthumb" style="background:'+p.bg+'"><svg width="30" height="30" viewBox="0 0 60 60"><use href="#'+p.ico+'" color="white"/></svg></div>'
        +'<div><div class="rt2">'+esc(p.title)+'</div><div class="rm"><span class="badge '+badgeClass(p.type)+'">'+typeLabel(p.type)+'</span></div></div></div>';
    }
    rl.innerHTML = html;
  }
}

// –ü–æ–∏—Å–∫
var _searchTimer = null;
function onSearch() {
  clearTimeout(_searchTimer);
  _searchTimer = setTimeout(doSearch, 200);
}
function setChip(el, type) {
  document.querySelectorAll('.chip').forEach(function(c){ c.classList.remove('on'); });
  el.classList.add('on');
  CHIP = type;
  doSearch();
}
function doSearch() {
  var q = (document.getElementById('srch').value||'').trim().toLowerCase();
  var show = q || CHIP !== 'all';
  document.getElementById('search-res').style.display = show ? 'block' : 'none';
  document.getElementById('home-default').style.display = show ? 'none' : 'block';
  if (show) {
    var filtered = POSTS.filter(function(p){
      var mq = !q || (p.title+' '+p.content+' '+p.tags).toLowerCase().indexOf(q) >= 0;
      var mt = CHIP === 'all' || p.type === CHIP;
      return mq && mt;
    });
    renderCards('search-res', filtered);
  }
}
function filterCat(cat) {
  document.getElementById('srch').value = '';
  CHIP = 'all';
  document.querySelectorAll('.chip').forEach(function(c,i){ c.classList.toggle('on', i===0); });
  document.getElementById('search-res').style.display = 'block';
  document.getElementById('home-default').style.display = 'none';
  renderCards('search-res', POSTS.filter(function(p){ return p.cat === cat; }));
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// –ö–ê–†–¢–û–ß–ö–ò –ü–û–°–¢–û–í
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
function renderCards(elId, posts) {
  var el = document.getElementById(elId);
  if (!el) return;
  if (!posts.length) {
    el.innerHTML = '<div class="empty"><div class="empty-t">–ù–∏—á–µ–≥–æ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ</div><div class="empty-s">–ü–æ–ø—Ä–æ–±—É–π—Ç–µ –¥—Ä—É–≥–æ–π –∑–∞–ø—Ä–æ—Å</div></div>';
    return;
  }
  var html = '';
  for (var i = 0; i < posts.length; i++) {
    var p = posts[i];
    var sid = String(p.id);
    var fav = !!FAVS[sid];
    html += '<div class="pcard" onclick="openPost(\''+sid+'\')"><div class="pcard-img" style="background:'+p.bg+'">'
      +'<svg width="65" height="65" viewBox="0 0 60 60" style="position:relative;z-index:1"><use href="#'+p.ico+'" color="white"/></svg>'
      +'<div class="pcard-img-ov"></div></div><div class="pcard-body"><div class="pcard-top">'
      +'<div class="pcard-title">'+esc(p.title)+'</div>'
      +'<button class="favbtn" onclick="event.stopPropagation();toggleFav(\''+sid+'\',this)" style="color:'+(fav?'#fbbf24':'#aaa')+'">'
      +'<svg width="18" height="18" viewBox="0 0 24 24" fill="'+(fav?'#fbbf24':'none')+'" stroke="currentColor" stroke-width="2"><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/></svg>'
      +'</button></div><div class="pcard-prev">'+esc(p.content.slice(0,120))+'</div>'
      +'<div class="pcard-foot"><span class="badge '+badgeClass(p.type)+'">'+typeLabel(p.type)+'</span></div></div></div>';
  }
  el.innerHTML = html;
}

function renderCollections() {
  var el = document.getElementById('coll-list');
  if (!el) return;
  var posts = POSTS.filter(function(p){ return !!FAVS[String(p.id)]; });
  if (!posts.length) {
    el.innerHTML = '<div class="empty"><div class="empty-t">–ü–æ–¥–±–æ—Ä–∫–∏ –ø—É—Å—Ç—ã</div><div class="empty-s">–ù–∞–∂–º–∏ ‚òÖ –≤ –º–∞—Ç–µ—Ä–∏–∞–ª–µ —á—Ç–æ–±—ã —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å</div></div>';
    return;
  }
  renderCards('coll-list', posts);
}

function toggleFav(id, btn) {
  id = String(id);
  if (FAVS[id]) {
    delete FAVS[id];
    btn.style.color = '#aaa';
    btn.innerHTML = '<svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/></svg>';
  } else {
    FAVS[id] = 1;
    btn.style.color = '#fbbf24';
    btn.innerHTML = '<svg width="18" height="18" viewBox="0 0 24 24" fill="#fbbf24" stroke="#fbbf24" stroke-width="2"><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/></svg>';
    toast('–î–æ–±–∞–≤–ª–µ–Ω–æ –≤ –ø–æ–¥–±–æ—Ä–∫–∏');
  }
  if (CU) { saveFavs(CU.id, FAVS); setEl('am-favs', Object.keys(FAVS).length); }
  // –æ–±–Ω–æ–≤–ª—è–µ–º –∑–≤–µ–∑–¥—É –≤ –¥–µ—Ç–∞–ª—å–Ω–æ–º –ø—Ä–æ—Å–º–æ—Ç—Ä–µ
  updateDetFavBtn();
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// –î–ï–¢–ê–õ–¨–ù–´–ô –ü–†–û–°–ú–û–¢–† –ü–û–°–¢–ê
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
function openPost(id) {
  id = String(id);
  var p = null;
  for (var i = 0; i < POSTS.length; i++) if (String(POSTS[i].id) === id) { p = POSTS[i]; break; }
  if (!p) return;
  OPEN_POST = id;
  var det = document.getElementById('det');
  det.style.background = '#0e0e18';
  document.getElementById('det-hero').style.background = p.bg;
  document.getElementById('det-hero-svg').innerHTML = '<use href="#'+p.ico+'" color="white"/>';
  setEl('det-title', p.title);
  document.getElementById('det-badges').innerHTML = '<span class="badge '+badgeClass(p.type)+'">'+typeLabel(p.type)+'</span> <span style="font-size:11px;color:var(--txt2)">'+p.cat+'</span>';
  setEl('det-body-title', p.title);
  setEl('det-body', p.content);
  document.getElementById('det-tags').innerHTML = (p.tags||'').split(',').filter(Boolean).map(function(t){ return '<span class="tag">#'+t.trim()+'</span>'; }).join('');
  document.getElementById('det-watch').href  = p.tgLink  || 'https://t.me/+c4ekMHlWBbQzYjUy';
  document.getElementById('det-consp').href  = p.tgConsp || p.tgLink || 'https://t.me/+c4ekMHlWBbQzYjUy';
  updateDetFavBtn();
  det.classList.add('show');
  det.scrollTop = 0;
}

function closeDet() {
  document.getElementById('det').classList.remove('show');
  OPEN_POST = null;
  renderCollections();
}

function updateDetFavBtn() {
  if (!OPEN_POST) return;
  var isFav = !!FAVS[OPEN_POST];
  var svg = document.getElementById('det-fav-svg');
  if (svg) {
    svg.setAttribute('fill', isFav ? '#fbbf24' : 'none');
    svg.setAttribute('stroke', isFav ? '#fbbf24' : 'currentColor');
  }
}

function toggleDetFav() {
  if (!OPEN_POST) return;
  var id = OPEN_POST;
  if (FAVS[id]) {
    delete FAVS[id];
  } else {
    FAVS[id] = 1;
    toast('–î–æ–±–∞–≤–ª–µ–Ω–æ –≤ –ø–æ–¥–±–æ—Ä–∫–∏');
  }
  if (CU) saveFavs(CU.id, FAVS);
  updateDetFavBtn();
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// –†–ï–§–ï–†–ê–õ–¨–ù–ê–Ø –°–°–´–õ–ö–ê
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
function getRefUrl() {
  if (!CU) return '';
  var refId = String(CU.id).replace('tg','');
  return 'https://t.me/navigationinvestat_bot?startapp=ref_' + refId;
}

function copyRef(btnId, labelId) {
  var url = getRefUrl();
  if (!url) { toast('–°–Ω–∞—á–∞–ª–∞ –≤–æ–π–¥–∏—Ç–µ –≤ –∞–∫–∫–∞—É–Ω—Ç'); return; }
  doCopy(url, function(ok) {
    var btn = document.getElementById(btnId);
    if (!btn) return;
    if (ok) {
      btn.classList.add('copied');
      var prev = btn.textContent;
      btn.textContent = '‚úÖ –°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ!';
      setTimeout(function(){ btn.classList.remove('copied'); btn.innerHTML = btn.innerHTML.replace('‚úÖ –°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ!', prev) || ''; renderRefBtns(); }, 2000);
      toast('–°—Å—ã–ª–∫–∞ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∞!');
    } else {
      toast('–°—Å—ã–ª–∫–∞: ' + url);
    }
  });
}

function renderRefBtns() {
  // –ü—Ä–æ—Å—Ç–æ –æ–±–Ω–æ–≤–ª—è–µ–º —Ç–µ–∫—Å—Ç —Å—Å—ã–ª–∫–∏
  var url = getRefUrl();
  setEl('hero-ref-link', url);
  setEl('am-ref-link', url);
}

function doCopy(text, cb) {
  if (navigator.clipboard && navigator.clipboard.writeText) {
    navigator.clipboard.writeText(text).then(function(){ cb(true); }).catch(function(){ fallbackCopy(text, cb); });
  } else {
    fallbackCopy(text, cb);
  }
}

function fallbackCopy(text, cb) {
  try {
    var ta = document.createElement('textarea');
    ta.value = text;
    ta.style.cssText = 'position:fixed;opacity:0;top:0;left:0;width:1px;height:1px';
    document.body.appendChild(ta);
    ta.focus(); ta.select();
    var ok = document.execCommand('copy');
    document.body.removeChild(ta);
    cb(ok);
  } catch(e) { cb(false); }
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// –õ–ò–î–ï–†–ë–û–†–î
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
var _lbUnsub = null;

function listenLeaderboard() {
  if (!window.FB_READY) { renderLbFallback(); return; }
  if (_lbUnsub) { try{ _lbUnsub(); }catch(e){} _lbUnsub = null; }
  try {
    _lbUnsub = window.fsSnap(window.fsColl(window.FS,'users'), function(snap) {
      var arr = [];
      snap.forEach(function(d) {
        var u = d.data();
        arr.push({ id:d.id, name:u.name||'–ò–Ω–≤–µ—Å—Ç–æ—Ä', username:u.username||'', refs:u.refs||0, pts:u.pts||0, col:u.col||'#3d5af1' });
      });
      arr.sort(function(a,b){ return b.refs - a.refs || b.pts - a.pts; });
      renderLb(arr.slice(0,10));
      setEl('lb-live', 'üü¢ live');
    }, function(){ renderLbFallback(); });
  } catch(e) { renderLbFallback(); }
}

function renderLb(arr) {
  if (!arr.length) { setElHTML('lb','<div style="text-align:center;padding:24px;color:var(--txt2)">–†–µ–π—Ç–∏–Ω–≥ –ø–æ–∫–∞ –ø—É—Å—Ç</div>'); return; }
  var html = '';
  for (var i = 0; i < arr.length; i++) {
    var u = arr[i];
    var isMe = CU && String(u.id).replace('tg','') === String(CU.id).replace('tg','');
    var rc = ['r1','r2','r3'][i] || 'rn';
    html += '<div class="lbi'+(isMe?' me':'')+'"><div class="lbr '+rc+'">'+(i+1)+'</div>'
      +'<div class="lbav" style="background:'+(u.col||'#3d5af1')+'">'+u.name[0].toUpperCase()+'</div>'
      +'<div style="flex:1"><div class="lbn'+(isMe?' me':'')+'">'+esc(u.name)+(u.username?'<span style="font-size:10px;color:var(--txt2);margin-left:4px">@'+u.username+'</span>':'')+(isMe?'<span style="font-size:10px;color:var(--acc);margin-left:4px">(–≤—ã)</span>':'')+'</div>'
      +'<div style="font-size:10px;color:var(--txt2)">'+(u.refs||0)+' –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏–π</div></div>'
      +'<div class="lbs">'+(u.refs||0)+'</div></div>';
  }
  setElHTML('lb', html);
}

function renderLbFallback() {
  if (CU) {
    renderLb([{id:CU.id,name:CU.name,username:CU.username||'',refs:CU.refs||0,pts:CU.pts||0,col:CU.col}]);
  } else {
    setElHTML('lb','<div style="text-align:center;padding:24px;color:var(--txt2)">–ó–∞–≥—Ä—É–∑–∫–∞...</div>');
  }
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// –£–¢–ò–õ–ò–¢–´
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
function badgeClass(type) {
  return {invest:'b-invest',case:'b-case',video:'b-video',post:'b-post',news:'b-news'}[type] || 'b-post';
}
function typeLabel(type) {
  return {invest:'–ò–Ω–≤–µ—Å—Ç–∏—Ü–∏–∏',case:'–ö–µ–π—Å',video:'–í–∏–¥–µ–æ',post:'–ü–æ—Å—Ç',news:'–ù–æ–≤–æ—Å—Ç—å'}[type] || type;
}
function esc(s) {
  return String(s||'').replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;').replace(/"/g,'&quot;');
}
function openLink(url) { window.open(url,'_blank'); }

var _toastTimer = null;
function toast(msg) {
  var el = document.getElementById('toast-el');
  if (!el) return;
  el.textContent = msg;
  el.classList.add('show');
  clearTimeout(_toastTimer);
  _toastTimer = setTimeout(function(){ el.classList.remove('show'); }, 2500);
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// –ê–î–ú–ò–ù –ü–ê–ù–ï–õ–¨
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
function isAdmin() {
  if (!CU) return false;
  var rawId = String(CU.id).replace('tg','');
  return ADMIN_IDS.indexOf(rawId) >= 0 || ADMIN_IDS.indexOf(CU.id) >= 0;
}

function checkAdminFab() {
  var fab = document.getElementById('admin-fab');
  if (fab) { if (isAdmin()) { fab.classList.add('visible'); } else { fab.classList.remove('visible'); } }
}

function openAdmin() {
  document.getElementById('admin-panel').style.display = 'block';
  switchAdmTab('posts', document.getElementById('atab-posts'));
}

function closeAdmin() {
  document.getElementById('admin-panel').style.display = 'none';
}

function switchAdmTab(name, btn) {
  document.querySelectorAll('.adm-tab').forEach(function(t){ t.classList.remove('on'); });
  if (btn) btn.classList.add('on');
  document.getElementById('adm-posts').style.display = name === 'posts' ? 'block' : 'none';
  document.getElementById('adm-users').style.display = name === 'users' ? 'block' : 'none';
  if (name === 'posts') admLoadPosts();
  if (name === 'users') admLoadUsers();
}

// –ü—É–±–ª–∏–∫–∞—Ü–∏—è –ø–æ—Å—Ç–∞
function admPublish() {
  var title   = (document.getElementById('ap-title').value||'').trim();
  var content = (document.getElementById('ap-content').value||'').trim();
  var cat     = document.getElementById('ap-cat').value;
  var type    = document.getElementById('ap-type').value;
  var tags    = (document.getElementById('ap-tags').value||'').trim();
  var link    = (document.getElementById('ap-link').value||'').trim() || 'https://t.me/+c4ekMHlWBbQzYjUy';
  var order   = parseInt(document.getElementById('ap-order').value) || (POSTS.length + 1);

  if (!title)   { toast('‚ö†Ô∏è –í–≤–µ–¥–∏ –∑–∞–≥–æ–ª–æ–≤–æ–∫'); return; }
  if (!content) { toast('‚ö†Ô∏è –í–≤–µ–¥–∏ —Ç–µ–∫—Å—Ç –ø–æ—Å—Ç–∞'); return; }
  if (!window.FB_READY) { toast('‚ùå Firebase –Ω–µ –ø–æ–¥–∫–ª—é—á—ë–Ω'); return; }

  var btn = document.getElementById('adm-pub-btn');
  btn.textContent = '‚è≥ –ü—É–±–ª–∏–∫—É—é...';
  btn.disabled = true;

  var m = CAT_META[cat] || CAT_META['–ò–Ω–≤–µ—Å—Ç–∏—Ü–∏–∏'];
  window.fsAdd(window.fsColl(window.FS,'posts'), {
    title:title, content:content, cat:cat, type:type, tags:tags,
    ico:m.ico, bg:m.bg, tgLink:link, tgConsp:link,
    order:order, published:true,
    createdAt: window.fsTs(),
    createdBy: CU ? String(CU.id) : 'admin'
  }).then(function(){
    toast('‚úÖ –ü–æ—Å—Ç –æ–ø—É–±–ª–∏–∫–æ–≤–∞–Ω!');
    ['ap-title','ap-content','ap-tags','ap-order'].forEach(function(id){ var e=document.getElementById(id); if(e)e.value=''; });
    btn.textContent = '+ –û–ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å';
    btn.disabled = false;
    admLoadPosts();
  }).catch(function(e){
    toast('‚ùå ' + e.message);
    btn.textContent = '+ –û–ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å';
    btn.disabled = false;
  });
}

function admLoadPosts() {
  if (!window.FB_READY) { setElHTML('adm-posts-list','<div style="color:var(--txt2);font-size:13px">Firebase –Ω–µ –ø–æ–¥–∫–ª—é—á—ë–Ω</div>'); return; }
  setElHTML('adm-posts-list','<div style="color:var(--txt2);font-size:13px;padding:8px 0">–ó–∞–≥—Ä—É–∑–∫–∞...</div>');
  window.fsGetDocs(window.fsColl(window.FS,'posts')).then(function(snap) {
    if (snap.empty) { setElHTML('adm-posts-list','<div style="color:var(--txt2);font-size:13px;padding:8px 0">–ü–æ—Å—Ç–æ–≤ –Ω–µ—Ç ‚Äî —Å–æ–∑–¥–∞–π –ø–µ—Ä–≤—ã–π –≤—ã—à–µ</div>'); return; }
    var posts = [];
    snap.forEach(function(d){ posts.push(Object.assign({docId:d.id}, d.data())); });
    posts.sort(function(a,b){ return (a.order||99)-(b.order||99); });
    var html = '';
    posts.forEach(function(p) {
      var hidden = p.published === false;
      html += '<div class="adm-post-row" style="'+(hidden?'opacity:.5':'')+'"><div style="width:36px;height:36px;border-radius:8px;flex-shrink:0;background:'+(p.bg||'#111')+';display:flex;align-items:center;justify-content:center"><svg width="20" height="20" viewBox="0 0 60 60"><use href="#'+(p.ico||'i-coin')+'" color="white"/></svg></div>'
        +'<div style="flex:1;min-width:0"><div style="font-size:13px;font-weight:600;color:var(--txt);overflow:hidden;text-overflow:ellipsis;white-space:nowrap">'
        +(hidden?'<span style="font-size:10px;background:rgba(224,48,80,.2);color:#ff8099;padding:1px 5px;border-radius:4px;margin-right:5px">—Å–∫—Ä—ã—Ç</span>':'')+esc(p.title||'‚Äî')+'</div>'
        +'<div style="font-size:11px;color:var(--txt2);margin-top:2px">'+(p.cat||'')+' ¬∑ –ø–æ—Ä—è–¥–æ–∫: '+(p.order||'‚Äî')+'</div></div>'
        +'<div style="display:flex;gap:6px;flex-shrink:0">'
        +(hidden
          ? '<button class="adm-post-restore" onclick="admRestorePost(\''+p.docId+'\')">üëÅ</button>'
          : '<button class="adm-post-del" onclick="admDeletePost(\''+p.docId+'\')"><svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="3 6 5 6 21 6"/><path d="M19 6l-1 14H6L5 6"/><path d="M10 11v6m4-6v6"/></svg></button>')
        +'</div></div>';
    });
    setElHTML('adm-posts-list', html);
  }).catch(function(e){ setElHTML('adm-posts-list','<div style="color:var(--red);font-size:13px">'+e.message+'</div>'); });
}

function admDeletePost(docId) {
  var ov = document.createElement('div');
  ov.className = 'confirm-overlay';
  ov.innerHTML = '<div class="confirm-box"><div style="font-size:32px;margin-bottom:12px">üóë</div><div style="font-size:15px;font-weight:700;color:var(--txt);margin-bottom:8px">–£–¥–∞–ª–∏—Ç—å –ø–æ—Å—Ç?</div><div style="font-size:12px;color:var(--txt2)">–ü–æ—Å—Ç –±—É–¥–µ—Ç —É–¥–∞–ª—ë–Ω –±–µ–∑–≤–æ–∑–≤—Ä–∞—Ç–Ω–æ</div><div class="confirm-row"><button class="confirm-cancel" onclick="this.closest(\'.confirm-overlay\').remove()">–û—Ç–º–µ–Ω–∞</button><button class="confirm-ok" id="del-ok">–£–¥–∞–ª–∏—Ç—å</button></div></div>';
  document.body.appendChild(ov);
  ov.querySelector('#del-ok').onclick = function() {
    ov.remove();
    window.fsDelete(window.fsDoc(window.FS,'posts',docId))
      .then(function(){ toast('üóë –£–¥–∞–ª–µ–Ω–æ'); admLoadPosts(); })
      .catch(function(e){ toast('–û—à–∏–±–∫–∞: '+e.message); });
  };
}

function admRestorePost(docId) {
  window.fsUpdate(window.fsDoc(window.FS,'posts',docId),{published:true})
    .then(function(){ toast('‚úÖ –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω'); admLoadPosts(); })
    .catch(function(e){ toast('–û—à–∏–±–∫–∞: '+e.message); });
}

function admLoadUsers() {
  if (!window.FB_READY) { setElHTML('adm-users-list','<div style="color:var(--txt2);font-size:13px">Firebase –Ω–µ –ø–æ–¥–∫–ª—é—á—ë–Ω</div>'); return; }
  setElHTML('adm-users-list','<div style="color:var(--txt2);font-size:13px;padding:8px 0">–ó–∞–≥—Ä—É–∑–∫–∞...</div>');
  window.fsGetDocs(window.fsColl(window.FS,'users')).then(function(snap) {
    if (snap.empty) { setElHTML('adm-users-list','<div style="color:var(--txt2);font-size:13px">–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –Ω–µ—Ç</div>'); return; }
    var users = [];
    snap.forEach(function(d){ users.push(Object.assign({docId:d.id}, d.data())); });
    users.sort(function(a,b){ return (b.refs||0)-(a.refs||0); });
    var html = '';
    users.forEach(function(u) {
      var tgId = String(u.docId).replace('tg','');
      var blocked = !!u.blocked;
      var isMe = CU && (tgId === String(CU.id).replace('tg',''));
      var isAdmUser = ADMIN_IDS.indexOf(tgId) >= 0;
      html += '<div class="adm-user-row"><div class="adm-user-top">'
        +'<div class="adm-av" style="background:'+(u.col||'#3d5af1')+'">'+((u.name||'?')[0].toUpperCase())+'</div>'
        +'<div style="flex:1;min-width:0"><div style="font-size:14px;font-weight:700;color:var(--txt)">'
        +esc(u.name||'‚Äî')
        +(isMe ? '<span style="font-size:10px;background:rgba(61,90,241,.2);color:#818cf8;padding:2px 6px;border-radius:5px;margin-left:5px">–í–´</span>' : '')
        +(isAdmUser && !isMe ? '<span style="font-size:10px;background:rgba(99,102,241,.2);color:#a5b4fc;padding:2px 6px;border-radius:5px;margin-left:5px">ADMIN</span>' : '')
        +(blocked ? '<span class="blocked-badge">–ó–ê–ë–õ–û–ö–ò–†–û–í–ê–ù</span>' : '')
        +'</div><div style="font-size:11px;color:var(--txt2);margin-top:2px">'+(u.username?'@'+u.username+' ¬∑ ':'')+esc(u.email||'')+'</div></div>'
        +(!isMe ? '<button class="adm-block-btn '+(blocked?'unblock':'block')+'" onclick="admToggleBlock(\''+u.docId+'\','+blocked+')">'+(blocked?'‚úÖ –†–∞–∑–±–ª–æ–∫':'üö´ –ë–ª–æ–∫')+'</button>' : '')
        +'</div>'
        +'<div class="adm-user-stats"><span class="adm-stat">üë• –†–µ—Ñ–µ—Ä–∞–ª—ã: <b>'+(u.refs||0)+'</b></span><span class="adm-stat">‚≠ê –ë–∞–ª–ª—ã: <b>'+(u.pts||0)+'</b></span><span class="adm-stat">üì± '+(u.platform||'‚Äî')+'</span></div>'
        +'<div class="adm-tgid">TG ID: '+tgId+'  ¬∑  ID –≤ –±–∞–∑–µ: '+u.docId+'</div>'
        +'<div style="display:flex;gap:8px;align-items:center;margin-bottom:8px">'
        +(u.phone ? '<span style="font-size:12px;color:var(--txt2)">üìû '+u.phone+'</span>' : '')
        +(u.username ? '<a href="https://t.me/'+u.username+'" target="_blank" style="font-size:11px;background:rgba(61,90,241,.15);color:#818cf8;padding:4px 10px;border-radius:7px;text-decoration:none;font-weight:700">‚úâÔ∏è –ù–∞–ø–∏—Å–∞—Ç—å</a>' : '')
        +'</div>'
        +(!isMe ? '<button class="adm-ref-btn" onclick="admGiveRef(\''+u.docId+'\',\''+esc(u.name||'')+'\')">+ –ó–∞—á–∏—Å–ª–∏—Ç—å —Ä–µ—Ñ–µ—Ä–∞–ª –≤—Ä—É—á–Ω—É—é</button>' : '')
        +(u.lastSeen ? '<div style="font-size:10px;color:#555;margin-top:6px">–í—Ö–æ–¥: '+new Date(u.lastSeen).toLocaleString('ru')+'</div>' : '')
        +'</div>';
    });
    setElHTML('adm-users-list', html);
  }).catch(function(e){ setElHTML('adm-users-list','<div style="color:var(--red);font-size:13px">'+e.message+'</div>'); });
}

function admToggleBlock(docId, isBlocked) {
  window.fsUpdate(window.fsDoc(window.FS,'users',docId), {blocked: !isBlocked})
    .then(function(){ toast(isBlocked ? '‚úÖ –†–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω' : 'üö´ –ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω'); admLoadUsers(); })
    .catch(function(e){ toast('–û—à–∏–±–∫–∞: '+e.message); });
}

function admGiveRef(toDocId, toName) {
  var ov = document.createElement('div');
  ov.className = 'confirm-overlay';
  ov.innerHTML = '<div class="confirm-box" style="text-align:left"><div style="font-size:14px;font-weight:700;color:var(--txt);margin-bottom:8px">–ó–∞—á–∏—Å–ª–∏—Ç—å —Ä–µ—Ñ–µ—Ä–∞–ª</div><div style="font-size:12px;color:var(--txt2);margin-bottom:12px">–ö–æ–º—É: <b style="color:#818cf8">'+esc(toName)+'</b></div><div style="font-size:12px;color:var(--txt2);margin-bottom:6px">Telegram ID –ø—Ä–∏–≥–ª–∞—Å–∏–≤—à–µ–≥–æ:</div><input id="ref-give-id" placeholder="5996401983" style="width:100%;background:var(--bg4);border:1px solid var(--brd2);border-radius:10px;padding:10px 12px;color:var(--txt);font-size:13px;font-family:Manrope;outline:none;box-sizing:border-box;margin-bottom:14px"><div class="confirm-row"><button class="confirm-cancel" onclick="this.closest(\'.confirm-overlay\').remove()">–û—Ç–º–µ–Ω–∞</button><button class="confirm-ok" style="background:linear-gradient(135deg,#3d5af1,#6366f1)" id="ref-give-ok">–ó–∞—á–∏—Å–ª–∏—Ç—å</button></div></div>';
  document.body.appendChild(ov);
  ov.querySelector('#ref-give-ok').onclick = function() {
    var invId = (document.getElementById('ref-give-id').value||'').trim();
    if (!invId) { toast('–í–≤–µ–¥–∏ ID'); return; }
    ov.remove();
    fbAddRef(invId, toDocId);
    toast('üéØ –ó–∞—á–∏—Å–ª—è–µ—Ç—Å—è...');
  };
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// –°–¢–ê–†–¢
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
if (document.readyState === 'loading') {
  document.addEventListener('DOMContentLoaded', boot);
} else {
  boot();
}
</script>

</body>
</html>